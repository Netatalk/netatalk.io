<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>netatalk: Name</title>
<link rel="icon" href="favicon.ico" type="image/x-icon" />
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">netatalk<span id="projectnumber">&#160;4.4.0dev</span>
   </div>
   <div id="projectbrief">Free and Open Source Apple Filing Protocol (AFP) Server</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('md_manpages_2man5_2afp_8conf_85.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Name </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md234"></a></p>
<p>afp.conf - Netatalk configuration file</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md235"></a>
Synopsis</h1>
<p>The <b>afp.conf</b> file is the configuration file for the <b>Netatalk</b> AFP file server.</p>
<p>All AFP-specific configurations and AFP volume definitions are done via this file.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md236"></a>
File Format</h1>
<p>The file consists of sections and parameters. A section begins with the name of the section in square brackets and continues until the next section begins. Sections contain parameters of the form: </p><pre class="fragment">option = value
</pre><p>The file is line-based - that is, each newline-terminated line represents either a comment, a section name or a parameter.</p>
<p>Parameter names are case sensitive, while section names are not.</p>
<p>Only the first equals sign in a parameter is significant. Whitespace before or after the first equals sign is discarded. Leading, trailing and internal whitespace in section and parameter names is irrelevant. Leading and trailing whitespace in a parameter value is discarded. Internal whitespace within a parameter value is retained verbatim.</p>
<p>Any line beginning with a semicolon (“;”) or a hash (“#”) character is ignored, as are lines containing only whitespace.</p>
<p>Any line ending in a **\** (backslash) is continued on the next line in the customary UNIX fashion.</p>
<p>The values following the equals sign in parameters are all either a string (no quotes needed) or a boolean, which may be given as yes/no, 1/0 or true/false. Case is not significant in boolean values, but is preserved in string values. Some options such as <b>file perm</b> take numeric values.</p>
<p>The parameter <b>include = path</b> allows you to include one config file inside another. The file is included literally, as though typed in place. Nested includes are not supported.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md237"></a>
Section Descriptions</h1>
<p>Each section in the configuration file (except for the [Global] section) describes a shared resource (known as a “volume”). The parameters within the section define the volume attributes and options.</p>
<p>There are two special sections, [Global] and [Homes], which are described under <em>special sections</em>. The following notes apply to ordinary section descriptions.</p>
<p>A volume consists of a directory to which access is being given plus a description of the access rights which are granted to the user of the service. For volumes the <b>path</b> option must specify the directory to share.</p>
<p>The name of the volume is defined via the <b>volume name</b> option. When absent, the volume name is the name of the section, expressed in lowercase.</p>
<p>Any volume section without <b>path</b> option is considered a <em>vol preset</em> which can be selected in other volume sections via the <b>vol preset</b> option and constitutes defaults for the volume. For any option specified both in a preset <em>and</em> in a volume section the volume section setting completely substitutes the preset option.</p>
<p>The access rights granted by the server are masked by the access rights granted to the specified or guest UNIX user by the host system. The server does not grant more access than the host system grants.</p>
<p>The following sample section defines an AFP volume. The user has full access to the path */foo/bar*. The share is accessed via the share name <em>Baz</em>: </p><pre class="fragment">[baz]
    volume name = Baz
    path = /foo/bar
</pre><h1 class="doxsection"><a class="anchor" id="autotoc_md238"></a>
Special Sections</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md239"></a>
The [Global] section</h2>
<p>Parameters in this section apply to the server as a whole. Parameters denoted by a (G) below are must be set in this section.</p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md240"></a>
The [Homes] section</h2>
<p>This section enable sharing of the UNIX server user home directories. The one mandatory option is <b>basedir regex</b>. It should be set to a path which matches the parent directory of the user homes.</p>
<p>Specifying the optional <b>path</b> parameter makes it so that only the subdirectory <b>path</b> is shared, rather than the entire home directory. The following example illustrates this. Given all user home directories are stored under */home*: </p><pre class="fragment">[Homes]
    path = afp-data
    basedir regex = /home
</pre><p>For a user <em>john</em> this results in an AFP home volume with a path of */home/john/afp-data*.</p>
<p>If <b>basedir regex</b> contains symlink, set the canonicalized absolute path. When */home* links to */usr/home*: </p><pre class="fragment">[Homes]
    basedir regex = /usr/home
</pre><p>The optional parameter <b>home name</b> can be used to change the Homes volume name, which is <em>$u's home</em> by default. See below for more information on VARIABLE SUBSTITUTIONS. </p><pre class="fragment">[Homes]
    home name = The home of $u
    basedir regex = /home
</pre><p>For the same user <em>john</em> this results in an AFP home volume called <em>The home of john</em>.</p>
<p>Any parameter denoted by a <b>(H)</b> below can be used in the Homes section.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md241"></a>
Parameters</h1>
<p>Parameters define the specific attributes of sections.</p>
<p>Some parameters are specific to the [Global] section (e.g., <b>log type</b>). All others are permissible only in volume sections. The letter <em>G</em> in parentheses indicates that a parameter is specific to the [Global] section. The letter <em>V</em> indicates that a parameter can be specified in a volume specific section.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md242"></a>
Variable Substitutions</h1>
<p>You can use variables in volume names. The use of variables in paths is limited to $u.</p>
<ol type="1">
<li>if you specify an unknown variable, it will not get converted.</li>
<li>if you specify a known variable, but that variable doesn't have a value, it will get ignored.</li>
</ol>
<p>The variables which can be used for substitutions are:</p>
<blockquote class="doxtable">
<p>$b</p>
<blockquote class="doxtable">
<p>basename </p>
</blockquote>
<p>$c</p>
<blockquote class="doxtable">
<p>client's ip address </p>
</blockquote>
<p>$d</p>
<blockquote class="doxtable">
<p>volume pathname on server </p>
</blockquote>
<p>$f</p>
<blockquote class="doxtable">
<p>full name (contents of the gecos field in the passwd file) </p>
</blockquote>
<p>$g</p>
<blockquote class="doxtable">
<p>group name </p>
</blockquote>
<p>$h</p>
<blockquote class="doxtable">
<p>hostname </p>
</blockquote>
<p>$i</p>
<blockquote class="doxtable">
<p>client's ip, without port </p>
</blockquote>
<p>$s</p>
<blockquote class="doxtable">
<p>server name (this can be the hostname) </p>
</blockquote>
<p>$u</p>
<blockquote class="doxtable">
<p>user name (if guest, it is the user that guest is running as) </p>
</blockquote>
<p>$v</p>
<blockquote class="doxtable">
<p>volume name </p>
</blockquote>
<p>$$</p>
<blockquote class="doxtable">
<p>prints dollar sign ($) </p>
</blockquote>
</blockquote>
<h1 class="doxsection"><a class="anchor" id="autotoc_md243"></a>
Explanation of Global Parameters</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md244"></a>
Authentication Options</h2>
<p>ad domain = <em>domain</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Append @DOMAIN to username when authenticating. Useful in Active Directory environments that otherwise would require the user to enter the full user@domain string. </p>
</blockquote>
<p>admin auth user = <em>user</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Specifying e.g. "**admin auth user = root**" whenever a normal user login fails, afpd will try to authenticate as the specified <b>admin auth user</b>. If this succeeds, a normal session is created for the original connecting user. Said differently: if you know the password of <b>admin auth user</b>, you can authenticate as any other user. </p>
</blockquote>
<p>admin group = <em>group</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Allows users of a certain group to be seen as the superuser when they log in. This option is disabled by default. </p>
</blockquote>
<p>force user = <em>user</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>This specifies a UNIX user name that will be assigned as the default user for all users connecting to this server. This is useful for sharing files. You should also use it carefully as using it incorrectly can cause security problems. </p>
</blockquote>
<p>force group = <em>group</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>This specifies a UNIX group name that will be assigned as the default primary group for all users connecting to this server. </p>
</blockquote>
<p>guest account = <em>name</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Specifies the user that guests should use (default is <b>nobody</b>). The name must be a valid user on the host system. </p>
</blockquote>
<p>k5 keytab = <em>path</em> <b>(G)</b>; k5 service = <em>service</em> <b>(G)</b>; k5 realm = <em>realm</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>These are required if the server supports the Kerberos 5 authentication UAM. </p>
</blockquote>
<p>nt domain = <em>domain</em> <b>(G)</b>; nt separator = <em>SEPARATOR</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Use for e.g. winbind authentication, prepends both strings before the username from login and then tries to authenticate with the result through the available and active UAM authentication modules. </p>
</blockquote>
<p>save password = <em>BOOLEAN</em> (default: <em>yes</em>) <b>(G)</b></p>
<blockquote class="doxtable">
<p>Enables or disables the ability of clients to save passwords locally. </p>
</blockquote>
<p>set password = <em>BOOLEAN</em> (default: <em>no</em>) <b>(G)</b></p>
<blockquote class="doxtable">
<p>Enables or disables the ability of clients to change their passwords via chooser or the "connect to server" dialog. </p>
</blockquote>
<p>uam list = <em>uam list</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Space or comma separated list of UAMs. (The default is "uams_dhx.so
uams_dhx2.so"). </p>
</blockquote>
<p>The most commonly used UAMs are:</p>
<blockquote class="doxtable">
<p>uams_guest.so</p>
<blockquote class="doxtable">
<p>Allows guest logins. </p>
</blockquote>
<p>uams_clrtxt.so</p>
<blockquote class="doxtable">
<p>(uams_pam.so or uams_passwd.so) Allow logins with passwords transmitted in the clear. Compatible with Mac OS 9 and earlier. </p>
</blockquote>
<p>uams_randnum.so</p>
<blockquote class="doxtable">
<p>Allows Random Number and Two-Way Random Number Exchange for authentication (requires a separate file containing the passwords, either the default <em>afppasswd</em> file or the one specified via "**passwd file**"). See <b>afppasswd</b>(1) for details. Compatible with Mac OS 9 and earlier. </p>
</blockquote>
<p>uams_dhx.so</p>
<blockquote class="doxtable">
<p>(uams_dhx_pam.so or uams_dhx_passwd.so) Allow Diffie-Hellman eXchange (DHX) for authentication. </p>
</blockquote>
<p>uams_dhx2.so</p>
<blockquote class="doxtable">
<p>(uams_dhx2_pam.so or uams_dhx2_passwd.so) Allow Diffie-Hellman eXchange 2 (DHX2) for authentication. </p>
</blockquote>
<p>uam_gss.so</p>
<blockquote class="doxtable">
<p>Allow Kerberos V for authentication (optional) </p>
</blockquote>
</blockquote>
<p>uam path = <em>path</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Sets the default path for UAMs for this server. </p>
</blockquote>
<p>valid shellcheck = <em>BOOLEAN</em> (default: <em>yes</em>) <b>(G)</b></p>
<blockquote class="doxtable">
<p>Whether to check if the user's login shell is valid (i.e. listed in /etc/shells). If the user's shell is not valid, authentication will fail. This is a security feature to prevent users with nologin shells from logging in. Disable this option to allow users with nologin shells to log in. </p>
</blockquote>
<h2 class="doxsection"><a class="anchor" id="autotoc_md245"></a>
Charset Options</h2>
<p>With OS X Apple introduced the AFP3 protocol. One of the big changes was, that AFP3 uses Unicode names encoded as Decomposed UTF-8 (UTF8-MAC). Previous AFP/OS versions used charsets like MacRoman, MacCentralEurope, etc.</p>
<p>To be able to serve AFP3 and older clients at the same time, <b>afpd</b> needs to be able to convert between UTF-8 and Mac charsets. Even OS X clients partly still rely on the mac charset. As there's no way, <b>afpd</b> can detect the codepage a pre AFP3 client uses, you have to specify it using the <b>mac charset</b> option. The default is MacRoman, which should be fine for most western users.</p>
<p>As <b>afpd</b> needs to interact with UNIX operating system as well, it needs to be able to convert from UTF8-MAC / Mac charset to the UNIX charset. By default <b>afpd</b> uses <em>UTF8</em>. You can set the UNIX charset using the <b>unix charset</b> option. If you're using extended characters in the configuration files for <b>afpd</b>, make sure your terminal matches the <b>unix charset</b>.</p>
<p>mac charset = <em>charset</em> <b>(G)</b>/**(V)**</p>
<blockquote class="doxtable">
<p>Specifies the Mac clients charset, e.g. <em>MAC_ROMAN</em>. This is used to convert strings and filenames to the clients codepage for OS9 and Classic, i.e. for authentication and AFP messages (SIGUSR2 messaging). This will also be the default for the volumes <b>mac charset</b>. Defaults to <em>MAC_ROMAN</em>. </p>
</blockquote>
<p>unix charset = <em>charset</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Specifies the servers unix charset, e.g. <em>ISO-8859-15</em> or <em>EUC-JP</em>. This is used to convert strings to/from the systems locale, e.g. for authentication, server messages and volume names. If <em>LOCALE</em> is set, the systems locale is used. Defaults to <em>UTF8</em>. </p>
</blockquote>
<p>vol charset = <em>charset</em> <b>(G)</b>/**(V)**</p>
<blockquote class="doxtable">
<p>Specifies the encoding of the volumes filesystem. By default, it is the same as <b>unix charset</b>.</p>
<p><em><b>NOTE:</b></em> It is highly recommended to stick to the default UTF-8 encoding. </p>
</blockquote>
<h2 class="doxsection"><a class="anchor" id="autotoc_md246"></a>
Password Options</h2>
<p>passwd file = <em>path</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Sets the path to the Randnum UAM passwd file for this server. </p>
</blockquote>
<p>passwd minlen = <em>number</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Sets the minimum password length, if supported by the UAM </p>
</blockquote>
<h2 class="doxsection"><a class="anchor" id="autotoc_md247"></a>
Network Options</h2>
<p>advertise ssh = <em>BOOLEAN</em> (default: <em>no</em>) <b>(G)</b></p>
<blockquote class="doxtable">
<p>Allows old Mac OS X clients (10.3.3-10.4) to automagically establish a tunneled AFP connection through SSH. If this option is set, the server's answers to client's FPGetSrvrInfo requests contain an additional entry. It depends on both client's settings and a correctly configured and running <b>sshd</b>(8) on the server to let things work.</p>
<p><em><b>NOTE:</b></em> Setting this option is not recommended since globally encrypting AFP connections via SSH will increase the server's load significantly. On the other hand, Apple's client side implementation of this feature in Mac OS X versions prior to 10.3.4 contained a security flaw. </p>
</blockquote>
<p>afp interfaces = <em>name [name ...]</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Specifies the network interfaces that the server should listen on. The default is to advertise the first IP address of the system, while listening for any incoming request.</p>
<p><em><b>NOTE:</b></em> Do not use at the same time as the <b>afp listen</b> option. </p>
</blockquote>
<p>afp listen = <em>ip address[:port] [ip address[:port] ...]</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Specifies the IP address that the server should advertise <b>and</b> listens to. The default is advertise the first IP address of the system, but to listen for any incoming request. The network address may be specified either in dotted-decimal format for IPv4 or in hexadecimal format for IPv6.</p>
<p>IPv6 address + port combination must use URL the format using square brackets [IPv6]:port</p>
<p><em><b>NOTE:</b></em> Do not use at the same time as the <b>afp interfaces</b> option. </p>
</blockquote>
<p>afp port = <em>port number</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Allows a different TCP port to be used for AFP. The default is 548. Also sets the default port applied when none specified in an <b>afp listen</b> option. </p>
</blockquote>
<p>afp read locks = <em>BOOLEAN</em> (default: <em>no</em>) <b>(G)</b></p>
<blockquote class="doxtable">
<p>Whether to apply locks to the byte region read in FPRead calls. The AFP spec mandates this, but it's not really in line with UNIX semantics and is a performance hog. </p>
</blockquote>
<p>cnid listen = <em>ip address[:port] [ip address[:port] ...]</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Specifies the IP address and port that the CNID server should listen on. This should match the address and port of the <b>cnid server</b> option for most deployments. The default is <b>localhost:4700</b>. </p>
</blockquote>
<p>disconnect time = <em>number</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Keep disconnected AFP sessions for <em>number</em> hours before dropping them. Default is 24 hours. </p>
</blockquote>
<p>dsireadbuf = <em>number</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Scale factor that determines the size of the DSI/TCP readahead buffer, default is 12. This is multiplies with the <a class="el" href="struct_d_s_i.html">DSI</a> server quantum (default 1MiB) to give the size of the buffer. Increasing this value might increase throughput in fast local networks for volume to volume copies.</p>
<p><em><b>NOTE:</b></em> This buffer is allocated per afpd child process, so specifying large values will eat up large amount of memory (buffer size * number of clients). </p>
</blockquote>
<p>fqdn = <em>name[:port]</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Specifies a fully-qualified domain name, with an optional port. This is discarded if the server cannot resolve it. This option is not honored by AppleShare clients &lt;= 3.8.3. This option is disabled by default. Use with caution as this will involve a second name resolution step on the client side. Also note that afpd will advertise this name:port combination but not automatically listen to it. </p>
</blockquote>
<p>hostname = <em>name</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Use this instead of the result from calling hostname for determining which IP address to advertise, therefore the hostname is resolved to an IP which is the advertised. This is NOT used for listening and can be overridden by <b>afp listen</b>. </p>
</blockquote>
<p>max connections = <em>number</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Sets the maximum number of clients that can simultaneously connect to the server (default is 200). </p>
</blockquote>
<p>server quantum = <em>number</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>This specifies the <a class="el" href="struct_d_s_i.html">DSI</a> server quantum. The default value is 0x100000 (1 MiB). The maximum value is 0xFFFFFFFFF, the minimum is 32000. If you specify a value that is out of range, the default value will be set. Do not change this value unless you're absolutely sure, what you're doing </p>
</blockquote>
<p>sleep time = <em>number</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Keep sleeping AFP sessions for <em>number</em> hours before disconnecting clients in sleep mode. Default is 10 hours. </p>
</blockquote>
<p>tcprcvbuf = <em>number</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Try to set TCP receive buffer using setsockopt(). Often OSes impose restrictions on the applications ability to set this value. </p>
</blockquote>
<p>tcpsndbuf = <em>number</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Try to set TCP send buffer using setsockopt(). Often OSes impose restrictions on the applications ability to set this value. </p>
</blockquote>
<p>recvfile = <em>BOOLEAN</em> (default: <em>no</em>) <b>(G)</b></p>
<blockquote class="doxtable">
<p>Whether to use splice() on Linux for receiving data. </p>
</blockquote>
<p>splice size = <em>number</em> (default: <em>64k</em>) <b>(G)</b></p>
<blockquote class="doxtable">
<p>Maximum number of bytes spliced. </p>
</blockquote>
<p>use sendfile = <em>BOOLEAN</em> (default: <em>yes</em>) <b>(G)</b></p>
<blockquote class="doxtable">
<p>Whether to use sendfile syscall for sending file data to clients. </p>
</blockquote>
<p>zeroconf = <em>BOOLEAN</em> (default: <em>yes</em>) <b>(G)</b></p>
<blockquote class="doxtable">
<p>Whether to use automatic Zeroconf service registration if Avahi or mDNSResponder were compiled in. </p>
</blockquote>
<h2 class="doxsection"><a class="anchor" id="autotoc_md248"></a>
CNID Database Backend Options</h2>
<p>Global configurations specific to the CNID database backend, which controls how the database is stored and accessed.</p>
<p>For granular control over the CNID database backend, see the Volume Parameters section below.</p>
<p>cnid mysql host = <em>MySQL server address</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>name or address of a MySQL server for use with the mysql CNID backend. </p>
</blockquote>
<p>cnid mysql user = <em>MySQL user</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>MySQL user for authentication with the server. </p>
</blockquote>
<p>cnid mysql pw = <em>password</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Password for MySQL server. </p>
</blockquote>
<p>cnid mysql db = <em>database name</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Name of an existing database for which the specified user has full privileges. </p>
</blockquote>
<p>cnid server = <em>ipaddress[:port]</em> <b>(G)</b>/**(V)**</p>
<blockquote class="doxtable">
<p>Specifies the IP address and port of a cnid_metad server, required for the CNID dbd backend. This should match the address and port of the <b>cnid listen</b> option for most deployments. Defaults to localhost:4700.</p>
<p>The network address may be specified either in dotted-decimal format for IPv4 or in hexadecimal format for IPv6. </p>
</blockquote>
<p>vol dbpath = <em>path</em> <b>(G)</b>/**(V)**</p>
<blockquote class="doxtable">
<p>Sets the path where the database information will be stored. You have to specify a writable location, even if the volume is read only. </p>
</blockquote>
<p>vol dbnest = <em>BOOLEAN</em> (default: <em>no</em>) <b>(G)</b></p>
<blockquote class="doxtable">
<p>Setting this option to true brings back Netatalk 2 behaviour of storing the CNID database in a folder called .AppleDB inside the volume root of each share. </p>
</blockquote>
<h2 class="doxsection"><a class="anchor" id="autotoc_md249"></a>
Directory Cache Tuning</h2>
<p>dircachesize = <em>number</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Maximum possible entries in the directory cache. The cache stores directories and files. Default size is 8192, maximum size is 131072. </p>
</blockquote>
<p>dircache validation freq = <em>number</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Directory cache validation frequency for external change detection. Value of 1 means validate every access (default for backward compatibility), higher values validate less frequently. If Netatalk is the only process accessing the volume you can safely set a value of 100 for maximum performance. </p>
</blockquote>
<p>dircache metadata window = <em>number</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Time window in seconds for distinguishing metadata-only changes from content changes in directories. Default: 300 seconds (5 minutes). Range: 60-3600 seconds. If Netatalk is the only process accessing the volume you can safely set a value of 3600. </p>
</blockquote>
<p>dircache metadata threshold = <em>number</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Maximum time difference in seconds between cached and current directory ctime to be considered a metadata-only change. Default: 60 seconds (1 minute). Range: 10-1800 seconds. If Netatalk is the only process accessing the volume you can safely set a value of 1800. </p>
</blockquote>
<p><b>Note</b>: See Configuration chapter in the manual for more information</p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md250"></a>
Miscellaneous Options</h2>
<p>afpstats = <em>BOOLEAN</em> (default: <em>no</em>) <b>(G)</b></p>
<blockquote class="doxtable">
<p>Whether to provide AFP runtime statistics (connected users, open volumes) via dbus. </p>
</blockquote>
<p>close vol = <em>BOOLEAN</em> (default: <em>no</em>) <b>(G)</b></p>
<blockquote class="doxtable">
<p>Whether to close volumes possibly opened by clients when they're removed from the configuration and the configuration is reloaded. </p>
</blockquote>
<p>extmap file = <em>path</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Sets the path to the file which defines file extension type/creator mappings. </p>
</blockquote>
<p>force xattr with sticky bit = <em>BOOLEAN</em> (default: <em>no</em>) <b>(G)</b>/**(V)**</p>
<blockquote class="doxtable">
<p>Writing metadata xattr on directories with the sticky bit set may fail even though we may have write access to a directory, because if the sticky bit is set only the owner is allowed to write xattrs.</p>
<p>By enabling this option Netatalk will write the metadata xattr as root. </p>
</blockquote>
<p>ignored attributes = <em>all</em> | <em>nowrite</em> | <em>nodelete</em> | <em>norename</em> <b>(G)</b>/**(V)**</p>
<blockquote class="doxtable">
<p>Specify a set of file and directory attributes that shall be ignored by the server, <em>all</em> includes all the other options.</p>
<p>In OS X when the Finder sets a lock on a file/directory or you set the BSD uchg flag in the Terminal, all three attributes are used. Thus in order to ignore the Finder lock/BSD uchg flag, add set <em>ignored attributes = all</em>. </p>
</blockquote>
<p>mimic model = <em>model</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Specifies a custom icon for the mounted AFP volume on macOS (Mac OS X) clients. Default is to let macOS choose. Requires netatalk to be built with Zeroconf. Examples:</p>
<ul>
<li><b>Laptop</b></li>
<li><b>RackMount</b></li>
<li><b>Tower</b></li>
</ul>
<p>A complete set of supported model codes by a macOS client can be found by inspecting system properties files, such as */System/Library/CoreServices/CoreTypes.bundle/Contents/Info.plist* on macOS 15 Sequoia. </p>
</blockquote>
<p>server name = <em>name</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Specifies a human-readable name that uniquely describes the AFP server. Defaults to the value of <b>hostname</b> up until the first period. When netatalk is built with Zeroconf support, this is also registered as the service name and advertised as UTF-8, up to 63 octets (bytes) in length. </p>
</blockquote>
<p>signature = <em>STRING</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Specify a server signature. The maximum length is 16 characters. This option is useful for clustered environments, to provide fault isolation etc. By default, afpd generates a signature and saves it to a file called <b>afp_signature.conf</b> automatically (based on random numbers). See also asip-status(1). </p>
</blockquote>
<p>solaris share reservations = <em>BOOLEAN</em> (default: <em>yes</em>) <b>(G)</b></p>
<blockquote class="doxtable">
<p>Use share reservations on Solaris. Solaris CIFS server uses this too, so this makes a lock coherent multi protocol server. </p>
</blockquote>
<p>veto message = <em>BOOLEAN</em> (default: <em>no</em>) <b>(G)</b></p>
<blockquote class="doxtable">
<p>Send optional AFP messages for vetoed files. Then whenever a client tries to access any file or directory with a vetoed name, it will be sent an AFP message indicating the name and the directory. </p>
</blockquote>
<p>volnamelen = <em>number</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Max length of UTF8-MAC volume name for Mac OS X. Note that Hangul is especially sensitive to this. </p>
</blockquote>
<pre class="fragment">73: limit of Mac OS X 10.1
80: limit of Mac OS X 10.4/10.5 (default)
255: limit of recent Mac OS X
</pre><blockquote class="doxtable">
<p>Mac OS 9 and earlier are not influenced by this, because Maccharset volume name is always limited to 27 bytes. </p>
</blockquote>
<p>vol preset = <em>name</em> <b>(G)</b>/**(V)**</p>
<blockquote class="doxtable">
<p>Use section <em>name</em> as option preset for all volumes (when set in the [Global] section) or for one volume (when set in that volume's section). </p>
</blockquote>
<h2 class="doxsection"><a class="anchor" id="autotoc_md251"></a>
Spotlight Options</h2>
<p>Configure Netatalk's Spotlight compatibility layer.</p>
<p>dbus daemon = <em>path</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Sets the path to dbus-daemon binary used by the Spotlight feature. Can be used when the compile-time default path does not match the runtime environment. </p>
</blockquote>
<p>sparql results limit = <em>NUMBER</em> (default: <em>UNLIMITED</em>) <b>(G)</b></p>
<blockquote class="doxtable">
<p>Impose a limit on the number of results queried from Tracker or LocalSearch via SPARQL queries. </p>
</blockquote>
<p>spotlight = <em>BOOLEAN</em> (default: <em>no</em>) <b>(G)</b>/**(V)**</p>
<blockquote class="doxtable">
<p>Whether to enable Spotlight searches. Note: once the global option is enabled, any volume that is not enabled won't be searchable at all. See also <em>dbus daemon</em> option. </p>
</blockquote>
<p>spotlight attributes = <em>COMMA SEPARATED STRING</em> (default: <em>EMPTY</em>) <b>(G)</b></p>
<blockquote class="doxtable">
<p>A list of attributes that are allowed to be used in Spotlight searches. By default all attributes can be searched, passing a string limits attributes to elements of the string. Example: </p>
</blockquote>
<pre class="fragment">spotlight attributes = *,kMDItemTextContent
</pre><p>spotlight expr = <em>BOOLEAN</em> (default: <em>yes</em>) <b>(G)</b></p>
<blockquote class="doxtable">
<p>Whether to allow the use of logic expression in searches. </p>
</blockquote>
<h2 class="doxsection"><a class="anchor" id="autotoc_md252"></a>
Logging Options</h2>
<p>Control what kinds of messages are logged, and where they are logged.</p>
<p>log file = <em>logfile</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Write logs to <em>logfile</em> on the file system. If not specified, Netatalk logs to the syslog daemon facility. </p>
</blockquote>
<p>log level = <em>type:level [type:level ...]</em> <b>(G)</b>; log level = <em>type:level,[type:level, ...]</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Specify that any message of a loglevel up to the given <em>log level</em> should be logged.</p>
<p>By default afpd logs to syslog with a default logging setup equivalent to <b>default:note</b></p>
<p>logtypes: default, logger, cnid, afpd, dsi, uams, fce, ad, sl</p>
<p>loglevels: severe, error, warn, note, info, debug, debug6, debug7, debug8, debug9, maxdebug</p>
<p><em><b>NOTE:</b></em> Both logtype and loglevels are case insensitive. </p>
</blockquote>
<p>log microseconds = <em>BOOLEAN</em> (default: <em>yes</em>) <b>(G)</b></p>
<blockquote class="doxtable">
<p>Log timestamps with accuracy down to microseconds. If disabled, the timestamps record only whole seconds. Only takes effect when used in tandem with the <b>log file</b> option. </p>
</blockquote>
<h2 class="doxsection"><a class="anchor" id="autotoc_md253"></a>
Filesystem Change Events (FCE)</h2>
<p>Netatalk includes a nifty filesystem change event mechanism where afpd processes notify interested listeners about certain filesystem event by UDP network datagrams.</p>
<p>The following FCE events are defined:</p>
<ul>
<li>file modification (<b>fmod</b>)</li>
<li>file deletion (<b>fdel</b>)</li>
<li>directory deletion (<b>ddel</b>)</li>
<li>file creation (<b>fcre</b>)</li>
<li>directory creation (<b>dcre</b>)</li>
<li>file move or rename (<b>fmov</b>)</li>
<li>directory move or rename (<b>dmov</b>)</li>
<li>login (<b>login</b>)</li>
<li>logout (<b>logout</b>)</li>
</ul>
<p>fce listener = <em>host[:port]</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Enables sending FCE events to the specified <em>host</em>, default <em>port</em> is 12250 if not specified. Specifying multiple listeners is done by having this option once for each of them. </p>
</blockquote>
<p>fce version = <em>1</em> | <em>2</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>FCE protocol version, default is 1. You need version 2 for the fmov, dmov, login or logout events. </p>
</blockquote>
<p>fce events = <em>fmod,fdel,ddel,fcre,dcre,fmov,dmov,login,logout</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Specifies which FCE events are active, default is <b>fmod,fdel,ddel,fcre,dcre</b>. </p>
</blockquote>
<p>fce coalesce = <em>all</em> | <em>delete</em> | <em>create</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Coalesce FCE events. </p>
</blockquote>
<p>fce holdfmod = <em>seconds</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>This determines the time delay in seconds which is always waited if another file modification for the same file is done by a client before sending an FCE file modification event (fmod). For example saving a file in Photoshop would generate multiple events by itself because the application is opening, modifying and closing a file multiple times for every "save". Default: 60 seconds. </p>
</blockquote>
<p>fce sendwait = <em>milliseconds</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Defines a delay in milliseconds between the emission of each FCE event. Use this if you are experiencing lost FCE events when creating or deleting a very large number of files at once. The deluge of events that such an operation triggers can lead to UDP buffer overflow and subsequently to packet loss. Has to be a number between 0 and 999. Default: 0 milliseconds. </p>
</blockquote>
<p>fce ignore names = <em>NAME[,NAME2,...]</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Comma-delimited list of filenames for which FCE events shall not be generated. Default: <em>.DS_Store</em> </p>
</blockquote>
<p>fce ignore directories = <em>PATH[,PATH2,...]</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Comma-delimited list of paths to directories for which FCE events shall not be generated. Has to be an absolute path on the host file system. Must not end with a slash. Default: empty </p>
</blockquote>
<p>fce notify script = <em>path</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Script which will be executed for every FCE event. See <em>contrib/scripts/fce_ev_script.sh</em> in the Netatalk source tree for an example script. </p>
</blockquote>
<h2 class="doxsection"><a class="anchor" id="autotoc_md254"></a>
Options for ACL handling</h2>
<p>By default, the effective permission of the authenticated user are only mapped to the mentioned UARights permission structure, not the UNIX mode. You can adjust this behaviour with the configuration option <b>map acls</b>:</p>
<p>chmod request = <em>preserve</em> (default) | <em>ignore</em> | <em>simple</em> <b>(G)</b>/**(V)**</p>
<blockquote class="doxtable">
<p>Advanced permission control that deals with ACLs.</p>
<ul>
<li><b>ignore</b> - UNIX chmod() requests are completely ignored, use this option to allow the parent directory's ACL inheritance full control over new items.</li>
<li><b>preserve</b> - preserve ZFS ACEs for named users and groups or POSIX ACL group mask</li>
<li><b>simple</b> - just to a chmod() as requested without any extra steps </li>
</ul>
</blockquote>
<p>map acls = <em>none</em> | <em>rights</em> | <em>mode</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>none</p>
<blockquote class="doxtable">
<p>No mapping of ACLs. </p>
</blockquote>
<p>rights</p>
<blockquote class="doxtable">
<p>Effective permissions are mapped to UARights structure. This is the default. </p>
</blockquote>
<p>mode</p>
<blockquote class="doxtable">
<p>ACLs are additionally mapped to the UNIX mode of the filesystem object. </p>
</blockquote>
</blockquote>
<p>If you want to be able to display ACLs on the client, you must setup both client and server as part on a authentication domain (directory service, e.g. LDAP, Open Directory, Active Directory). The reason is, in OS X ACLs are bound to UUIDs, not just uid's or gid's. Therefore Netatalk must be able to map every filesystem uid and gid to a UUID so that it can return the server side ACLs which are bound to UNIX uid and gid mapped to OS X UUIDs.</p>
<p>Netatalk can query a directory server using LDAP queries. Either the directory server already provides an UUID attribute for user and groups (Active Directory, Open Directory) or you reuse an unused attribute (or add a new one) to you directory server (eg OpenLDAP).</p>
<p>The following LDAP options must be configured for Netatalk:</p>
<p>ldap auth method = <em>none</em> | <em>simple</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>none</p>
<blockquote class="doxtable">
<p>anonymous LDAP bind </p>
</blockquote>
<p>simple</p>
<blockquote class="doxtable">
<p>simple LDAP bind </p>
</blockquote>
</blockquote>
<p>ldap auth dn = <em>dn</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Distinguished Name of the user for simple bind. </p>
</blockquote>
<p>ldap auth pw = <em>password</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Password for simple bind. </p>
</blockquote>
<p>ldap uri = <em>ldap://somehost:1234/</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Specifies the LDAP URI of the server to connect to. The URI scheme may be ldap, ldapi or ldaps, specifying LDAP over TCP, ICP or TLS respectively (if supported by the LDAP library). This is only needed for explicit ACL support in order to be able to query LDAP for UUIDs.</p>
<p>You can use <b>afpldaptest</b>(1) to syntactically check your config. </p>
</blockquote>
<p>ldap userbase = <em>base dn</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>DN of the user container in LDAP. </p>
</blockquote>
<p>ldap userscope = <em>scope</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Search scope for user search: <b>base</b> | <b>one</b> | <b>sub</b> </p>
</blockquote>
<p>ldap groupbase = <em>base dn</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>DN of the group container in LDAP. </p>
</blockquote>
<p>ldap groupscope = <em>scope</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Search scope for group search: <b>base</b> | <b>one</b> | <b>sub</b> </p>
</blockquote>
<p>ldap uuid attr = <em>dn</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Name of the LDAP attribute with the UUIDs.</p>
<p><em><b>NOTE:</b></em> this is used both for users and groups. </p>
</blockquote>
<p>ldap name attr = <em>dn</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Name of the LDAP attribute with the users short name. </p>
</blockquote>
<p>ldap group attr = <em>dn</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Name of the LDAP attribute with the groups short name. </p>
</blockquote>
<p>ldap uuid string = <em>STRING</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Format of the uuid string in the directory. A series of x and -, where every x denotes a value 0-9a-f and every - is a separator.</p>
<p>Default: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx </p>
</blockquote>
<p>ldap uuid encoding = <em>string</em> (default) | <em>ms-guid</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Format of the UUID of the LDAP attribute, allows usage of the binary objectGUID fields from Active Directory. If left unspecified, string is the default, which passes through the ASCII UUID returned by most other LDAP stores. If set to ms-guid, the internal UUID representation is converted to and from the binary format used in the objectGUID attribute found on objects in Active Directory when interacting with the server.</p>
<p>See also the options <b>ldap user filter</b> and <b>ldap group filter</b>.</p>
<p>string</p>
<blockquote class="doxtable">
<p>UUID is a string, use with e.g. OpenDirectory. </p>
</blockquote>
<p>ms-guid</p>
<blockquote class="doxtable">
<p>Binary objectGUID from Active Directory </p>
</blockquote>
</blockquote>
<p>ldap user filter = <em>STRING</em> (default: unused) <b>(G)</b></p>
<blockquote class="doxtable">
<p>Optional LDAP filter that matches user objects. This is necessary for Active Directory environments where users and groups are stored in the same directory subtree.</p>
<p>Recommended setting for Active Directory: <b>objectClass=user</b>. </p>
</blockquote>
<p>ldap group filter = <em>STRING</em> (default: unused) <b>(G)</b></p>
<blockquote class="doxtable">
<p>Optional LDAP filter that matches group objects. This is necessary for Active Directory environments where users and groups are stored in the same directory subtree.</p>
<p>Recommended setting for Active Directory: <b>objectClass=group</b>. </p>
</blockquote>
<h2 class="doxsection"><a class="anchor" id="autotoc_md255"></a>
Classic Options</h2>
<p>Enable Netatalk features that are only relevant for Classic Mac OS or Apple II clients. See also the Charset options elsewhere in this manual.</p>
<p>appletalk = <em>BOOLEAN</em> (default: <em>no</em>) <b>(G)</b></p>
<blockquote class="doxtable">
<p>Enables support for AFP-over-AppleTalk. This option requires that your operating system supports the AppleTalk networking protocol, and that Netatalk was built with AppleTalk support. </p>
</blockquote>
<p>ddp address = <em>ddp address</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Specifies the DDP address of the server. The default is to auto-assign an address (0.0). This is only useful if you are running AppleTalk on more than one interface. </p>
</blockquote>
<p>ddp zone = <em>ddp zone</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Specifies the AppleTalk zone to register the server in. The default is to register the server in the default zone of the last interface configured by the system. </p>
</blockquote>
<p>legacy icon = <em>icon</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Sets the shared volume icon displayed in the Finder in Classic Mac OS. Note that some versions of Classic Mac OS ignores this icon. Examples of valid icon styles:</p>
<ul>
<li><b>daemon</b></li>
<li><b>globe</b></li>
<li><b>sdcard</b> </li>
</ul>
</blockquote>
<p>legacy volume size = <em>BOOLEAN</em> (default: <em>no</em>) <b>(V)</b></p>
<blockquote class="doxtable">
<p>Limit disk size reporting to 2GB for legacy clients. This can be used for older Macintoshes running System 7.1 or earlier and using newer AppleShare clients. </p>
</blockquote>
<p>login message = <em>message</em> <b>(G)</b>/**(V)**</p>
<blockquote class="doxtable">
<p>Sets a message to be displayed when Classic Mac OS clients log on to the server. The message should be in <b>unix charset</b>. Extended characters are allowed. </p>
</blockquote>
<p>prodos = <em>BOOLEAN</em> (default: <em>no</em>) <b>(V)</b></p>
<blockquote class="doxtable">
<p>Enable ProDOS support. This option should only be enabled for volumes you expect to netboot an Apple II from. In addition to setting the boot flag on the volume, it restricts the volume free space reported to the client to 32MB. </p>
</blockquote>
<h2 class="doxsection"><a class="anchor" id="autotoc_md256"></a>
Debug Parameters</h2>
<p>These options are useful for debugging only. Do <b>NOT</b> enable them in production environments!</p>
<p>tickleval = <em>number</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Sets the tickle timeout interval (in seconds). Defaults to 30. </p>
</blockquote>
<p>timeout = <em>number</em> <b>(G)</b></p>
<blockquote class="doxtable">
<p>Specify the number of tickles to send before timing out a connection. The default is 4, therefore a connection will timeout after 2 minutes. </p>
</blockquote>
<p>client polling = <em>BOOLEAN</em> (default: <em>no</em>) <b>(G)</b></p>
<blockquote class="doxtable">
<p>With this option enabled, afpd won't advertise that it is capable of server notifications, so that connected clients poll the server every 10 seconds to detect changes in opened server windows. </p>
</blockquote>
<h1 class="doxsection"><a class="anchor" id="autotoc_md257"></a>
Explanation of Volume Parameters</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md258"></a>
Home Section Parameters</h2>
<p>Special parameters that only apply to the home volume.</p>
<p>basedir regex = <em>regex</em> <b>(H)</b></p>
<blockquote class="doxtable">
<p>Regular expression which matches the parent directory of the user homes. If <b>basedir regex</b> contains symlink, you must set the canonicalized absolute path. In the simple case this is just a path i.e. <b>basedir regex = /home</b> </p>
</blockquote>
<p>home name = <em>name</em> <b>(H)</b></p>
<blockquote class="doxtable">
<p>AFP user home volume name. The default is <em>$u's home</em>. The name must contain "*$u*". </p>
</blockquote>
<h2 class="doxsection"><a class="anchor" id="autotoc_md259"></a>
Volume Sections Parameters</h2>
<p>Each volume should at least define <b>path</b> and <b>volume name</b>.</p>
<p>path = <em>path</em> <b>(V)</b></p>
<blockquote class="doxtable">
<p>The path name must be a fully qualified path name. </p>
</blockquote>
<p>volume name = <em>STRING</em> (default: section name in lowercase) <b>(V)</b></p>
<blockquote class="doxtable">
<p>The volume name option specifies the name of the shared AFP volume. When not set, this defaults to the name of the ini file section where the volume is defined, converted to lowercase.</p>
<p>No two volumes may have the same name. The volume name cannot contain the ':' character. The volume name is mangled if it is very long. Mac charset volume name is limited to 27 characters. UTF8-MAC volume name is limited to volnamelen parameter. </p>
</blockquote>
<p>vol size limit = <em>size in MiB</em> <b>(V)</b></p>
<blockquote class="doxtable">
<p>Useful for Time Machine: limits the reported volume size, thus preventing Time Machine from using the whole real disk space for backup. Example: "**vol size limit = 1000**" would limit the reported disk space to 1 GB.</p>
<p><em><b>IMPORTANT:</b></em> This is an approximated calculation taking into account the contents of Time Machine sparsebundle images. Therefore you MUST NOT use this volume to store other content when using this option, because it would NOT be accounted for. The calculation works by reading the band size from the Info.plist XML file of the sparsebundle, reading the bands/ directory counting the number of band files, and then multiplying one with the other. </p>
</blockquote>
<p>valid users = <em>user</em> / <em>@group</em> <b>(V)</b></p>
<blockquote class="doxtable">
<p>The allow option allows the users and groups that access a share to be specified. Users and groups are specified, delimited by spaces or commas. Groups are designated by a @ prefix. Example: </p>
</blockquote>
<pre class="fragment">valid users = user @group
</pre><p>invalid users = <em>user</em> / <em>@group</em> <b>(V)</b></p>
<blockquote class="doxtable">
<p>The deny option specifies users and groups who are not allowed access to the share. It follows the same format as the "valid users" option. </p>
</blockquote>
<p>hosts allow = <em>IP host address/IP netmask bits</em> [ ... ] <b>(V)</b></p>
<blockquote class="doxtable">
<p>Only listed hosts and networks are allowed, all others are rejected. The network address may be specified either in dotted-decimal format for IPv4 or in hexadecimal format for IPv6.</p>
<p>Example: hosts allow = 10.1.0.0/16 10.2.1.100 2001:0db8:1234::/48 </p>
</blockquote>
<p>hosts deny = <em>IP host address/IP netmask bits</em> [ ... ] <b>(V)</b></p>
<blockquote class="doxtable">
<p>Listed hosts and nets are rejected, all others are allowed.</p>
<p>Example: hosts deny = 192.168.100/24 10.1.1.1 2001:db8::1428:57ab </p>
</blockquote>
<p>cnid scheme = <em>backend</em> <b>(V)</b></p>
<blockquote class="doxtable">
<p>Set the CNID backend to be used for the volume. Run <b>afpd -v</b> to see a list of available backends, as well as which one is the default.</p>
<p><em>dbd</em> uses Berkeley DB, with database reads and writes managed through the <b>cnid_dbd</b> daemon. It is recommended for most deployments.</p>
<p>The <em>sqlite</em> backend uses the SQLite embedded database library. It is performant and lean, requiring no external database or daemon.</p>
<p>The <em>mysql</em> backend requires that a MySQL (or MariaDB) database instance has been provisioned for use with Netatalk. The upside is that you get full control over how the CNID data is stored, which makes for a robust and scalable solution.</p>
<p>The <em>last</em> backend uses a read-only, in-memory Trivial Database. It can be used to mount CD-ROMs and similar read-only media, for instance. </p>
</blockquote>
<p>ea = <em>sys</em> | <em>samba</em> | <em>ad</em> | <em>none</em> (default: auto detect) <b>(V)</b></p>
<blockquote class="doxtable">
<p>Specify how Extended Attributes and Classic Mac OS resource forks are stored.</p>
<p>By default, we attempt to enable <b>sys</b> with a fallback to <b>none</b>. For the auto detection to work, the volume needs to be writable because we attempt to set an EA on the shared directory itself. For read-only volumes, set this option explicitly.</p>
<p>sys</p>
<blockquote class="doxtable">
<p>Use filesystem Extended Attributes. </p>
</blockquote>
<p>samba</p>
<blockquote class="doxtable">
<p>Use filesystem Extended Attributes, but append a 0 byte to each xattr in order to be compatible with Samba's vfs_streams_xattr. </p>
</blockquote>
<p>ad</p>
<blockquote class="doxtable">
<p>Use AppleDouble v2 metadata stored as files in <em>.AppleDouble</em> directories. This should only be used when the host's filesystem does not support Extended Attributes. </p>
</blockquote>
<p>none</p>
<blockquote class="doxtable">
<p>No Extended Attributes support. </p>
</blockquote>
<p><em><b>WARNING:</b></em> The <b>samba</b> option should not be used on a volume that was previously set to <b>sys</b>. This may lead to data loss. </p>
</blockquote>
<p>mac charset = <em>charset</em> <b>(V)</b></p>
<blockquote class="doxtable">
<p>Specifies the Mac client charset for this Volume, e.g. <em>MAC_ROMAN</em>, <em>MAC_CYRILLIC</em>. If not specified the global setting is applied. This setting is only required if you need volumes, where the Mac charset differs from the one globally set in the [Global] section. </p>
</blockquote>
<p>casefold = <em>option</em> <b>(V)</b></p>
<blockquote class="doxtable">
<p>The casefold option handles, if the case of filenames should be changed. The available options are:</p>
<p><b>tolower</b> - Lowercases names in both directions.</p>
<p><b>toupper</b> - Uppercases names in both directions.</p>
<p><b>xlatelower</b> - Client sees lowercase, server sees uppercase.</p>
<p><b>xlateupper</b> - Client sees uppercase, server sees lowercase. </p>
</blockquote>
<p>password = <em>password</em> <b>(V)</b></p>
<blockquote class="doxtable">
<p>This option allows you to set a volume password, which can be a maximum of 8 characters long (using ASCII strongly recommended at the time of this writing). </p>
</blockquote>
<p>file perm = <em>mode</em> <b>(V)</b>; directory perm = <em>mode</em> <b>(V)</b></p>
<blockquote class="doxtable">
<p>Add(or) with the client requested permissions: <b>file perm</b> is for files only, <b>directory perm</b> is for directories only. Don't use with "**unix priv = no**".</p>
<p><b>Example</b>: Volume for a collaborative workgroup </p>
</blockquote>
<pre class="fragment">file perm = 0660
directory perm = 0770
</pre><p>umask = <em>mode</em> <b>(V)</b></p>
<blockquote class="doxtable">
<p>Set perm mask. Don't use with "**unix priv = no**". </p>
</blockquote>
<p>preexec = <em>command</em> <b>(V)</b></p>
<blockquote class="doxtable">
<p>Command to be run when the volume is mounted </p>
</blockquote>
<p>postexec = <em>command</em> <b>(V)</b></p>
<blockquote class="doxtable">
<p>Command to be run when the volume is closed </p>
</blockquote>
<p>rolist = <em>users/groups</em> <b>(V)</b></p>
<blockquote class="doxtable">
<p>Allows certain users and groups to have read-only access to a share. This follows the allow option format. </p>
</blockquote>
<p>rwlist = <em>users/groups</em> <b>(V)</b></p>
<blockquote class="doxtable">
<p>Allows certain users and groups to have read/write access to a share. This follows the allow option format. </p>
</blockquote>
<p>veto files = <em>vetoed names</em> <b>(V)</b></p>
<blockquote class="doxtable">
<p>Hide files and directories,where the path matches one of the '/' delimited vetoed names. The veto string must always be terminated with a '/', e.g. "**veto files = veto1/**", "**veto files = veto1/veto2/**". </p>
</blockquote>
<h2 class="doxsection"><a class="anchor" id="autotoc_md260"></a>
Volume options</h2>
<p>Boolean volume options.</p>
<p>acls = <em>BOOLEAN</em> (default: <em>yes</em>) <b>(V)</b></p>
<blockquote class="doxtable">
<p>Whether to flag volumes as supporting ACLs. If ACL support is compiled in, this is yes by default. </p>
</blockquote>
<p>case sensitive = <em>BOOLEAN</em> (default: <em>yes</em>) <b>(V)</b></p>
<blockquote class="doxtable">
<p>Whether to flag volumes as supporting case-sensitive filenames. If the filesystem is case-insensitive, set to no. However, it is not fully verified.</p>
<p><em><b>NOTE:</b></em> In spite of being case sensitive as a matter of fact, netatalk 3.1.3 and earlier did not notify kCaseSensitive flag to the client. Starting with 3.1.4, it is notified correctly by default. </p>
</blockquote>
<p>cnid dev = <em>BOOLEAN</em> (default: <em>yes</em>) <b>(V)</b></p>
<blockquote class="doxtable">
<p>Whether to use the device number in the CNID backends. Helps when the device number is not constant across a reboot, e.g. cluster, ... </p>
</blockquote>
<p>convert appledouble = <em>BOOLEAN</em> (default: <em>yes</em>) <b>(V)</b></p>
<blockquote class="doxtable">
<p>Whether automatic conversion from AppleDouble v2 to Extended Attributes is performed when accessing filesystems from clients. This is generally useful, but costs some performance. It's recommendable to run <b>dbd</b> on volumes and do the conversion with that. Then this option can be set to <em>no</em>. </p>
</blockquote>
<p>delete veto files = <em>BOOLEAN</em> (default: <em>no</em>) <b>(V)</b></p>
<blockquote class="doxtable">
<p>This option is used when Netatalk is attempting to delete a directory that contains one or more vetoed files or directories (see the veto files option). If this option is set to no (the default) then if a directory contains any non-vetoed files or directories then the directory delete will fail. This is usually what you want.</p>
<p>If this option is set to yes, then Netatalk will attempt to recursively delete any files and directories within the vetoed directory. </p>
</blockquote>
<p>follow symlinks = <em>BOOLEAN</em> (default: <em>no</em>) <b>(V)</b></p>
<blockquote class="doxtable">
<p>The default setting is false thus symlinks are not followed on the server. This is the same behaviour as OS X's AFP server. Setting the option to true causes afpd to follow symlinks on the server. symlinks may point outside of the AFP volume, currently afpd doesn't do any checks for "wide symlinks".</p>
<p><em><b>NOTE:</b></em> This option will subtly break when the symlinks point across filesystem boundaries. </p>
</blockquote>
<p>invisible dots = <em>BOOLEAN</em> (default: <em>no</em>) <b>(V)</b></p>
<blockquote class="doxtable">
<p>Make dot files invisible.</p>
<p><em><b>WARNING:</b></em> Enabling this option will lead to unwanted side effects where OS X applications, when saving files to a temporary file starting with a dot first, then renaming the temp file to its final name, result in the saved file being invisible. The only thing this option is useful for is making files that start with a dot invisible on Mac OS 9. It's completely useless on Mac OS X, as both in Finder and in Terminal files starting with a dot are hidden anyway. </p>
</blockquote>
<p>network ids = <em>BOOLEAN</em> (default: <em>yes</em>) <b>(V)</b></p>
<blockquote class="doxtable">
<p>Whether the server support network ids. Setting this to <em>no</em> will result in the client not using ACL AFP functions. </p>
</blockquote>
<p>preexec close = <em>BOOLEAN</em> (default: <em>no</em>) <b>(V)</b></p>
<blockquote class="doxtable">
<p>A non-zero return code from preexec close the volume being immediately, preventing clients to mount/see the volume in question. </p>
</blockquote>
<p>read only = <em>BOOLEAN</em> (default: <em>no</em>) <b>(V)</b></p>
<blockquote class="doxtable">
<p>Specifies the share as being read only for all users. Forces <b>ea = sys</b>. </p>
</blockquote>
<p>search db = <em>BOOLEAN</em> (default: <em>no</em>) <b>(V)</b></p>
<blockquote class="doxtable">
<p>Use fast CNID database namesearch instead of slow recursive filesystem search. Relies on a consistent CNID database, i.e. Samba or local filesystem access lead to inaccurate or wrong results. Works only for "dbd" CNID db volumes. </p>
</blockquote>
<p>stat vol = <em>BOOLEAN</em> (default: <em>yes</em>) <b>(V)</b></p>
<blockquote class="doxtable">
<p>Whether to stat volume path when enumerating volumes list, useful for automounting or volumes created by a preexec script. </p>
</blockquote>
<p>time machine = <em>BOOLEAN</em> (default: <em>no</em>) <b>(V)</b></p>
<blockquote class="doxtable">
<p>Whether to enable Time Machine support for this volume. </p>
</blockquote>
<p>unix priv = <em>BOOLEAN</em> (default: <em>yes</em>) <b>(V)</b></p>
<blockquote class="doxtable">
<p>Whether to use AFP3 UNIX privileges. This should be set for OS X clients. See also: <b>file perm</b>, <b>directory perm</b>, and <b>umask</b>. </p>
</blockquote>
<h1 class="doxsection"><a class="anchor" id="autotoc_md261"></a>
Examples</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md262"></a>
Example: Modern Mac clients</h2>
<p>This enables Spotlight and AFP stats if Netatalk was built with Spotlight and AFP stats support. The <b>mimic model</b> option is used to make the server look like an Xserve.</p>
<p>The home directory is mounted on */home/{user}/afp-data*. </p><pre class="fragment">[Global]
afpstats = yes
spotlight = yes
mimic model = RackMac

[Home]
basedir regex = /home
path = afp-data
</pre><h2 class="doxsection"><a class="anchor" id="autotoc_md263"></a>
Example: Classic Mac clients</h2>
<p>This enables AppleTalk if Netatalk was built with AppleTalk support. The Random Number and ClearTxt authentication modules are used. The <b>legacy icon</b> option is used to make the server look like a BSD Daemon.</p>
<p>With <b>legacy volume size</b> the volume size is limited to 2 GB for very old Macs, while <b>prodos</b> is used to enable ProDOS boot flags on the volume while limiting the volume free space to 32 MB. </p><pre class="fragment">[Global]
appletalk = yes
uam list = uams_dhx.so uams_dhx2.so uams_randnum.so uams_clrtxt.so
legacy icon = daemon

[mac]
volume name = Mac Files
path = /srv/mac
legacy volume size = yes

[apple2]
volume name = Apple II Files
path = /srv/apple2
prodos = yes
</pre><h1 class="doxsection"><a class="anchor" id="autotoc_md264"></a>
See Also</h1>
<p>afpd(8), afppasswd(5), afp_signature.conf(5), extmap.conf(5), cnid_metad(8)</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md265"></a>
Author</h1>
<p><a href="https://netatalk.io/contributors">Contributors to the Netatalk Project</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
