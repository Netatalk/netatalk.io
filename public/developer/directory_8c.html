<!-- HTML header for doxygen 1.14.0-->
<!-- modified for netatalk -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>netatalk: directory.c File Reference</title>
<link rel="icon" href="favicon.ico" type="image/x-icon" />
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<script
    src="https://cdn.jsdelivr.net/npm/mermaid@11.12.0/dist/mermaid.min.js"
    integrity="o+g/BxPwhi0C3RK7oQBxQuNimeafQ3GE/ST4iT2BxVI4Wzt60SH4pq9iXVYujjaS"
    crossorigin="anonymous"
></script>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
  <div id="projectrow">
    <div id="projectlogo">
      <a href="/"><img alt="Logo" src="logo.png"/></a>
    </div>
    <div id="projectalign">
      <div id="projectname">
        netatalk
        <span id="projectnumber">&#160;4.4.0dev</span>
      </div>
      <div id="projectbrief">Free and Open Source Apple Filing Protocol (AFP) Server</div>
    </div>
  </div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('directory_8c.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">directory.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;assert.h&gt;</code><br />
<code>#include &lt;errno.h&gt;</code><br />
<code>#include &lt;grp.h&gt;</code><br />
<code>#include &lt;pwd.h&gt;</code><br />
<code>#include &lt;stdbool.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;sys/param.h&gt;</code><br />
<code>#include &lt;sys/stat.h&gt;</code><br />
<code>#include &lt;utime.h&gt;</code><br />
<code>#include &lt;<a class="el" href="bstrlib_8h_source.html">bstrlib.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="adouble_8h_source.html">atalk/adouble.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="include_2atalk_2afp_8h_source.html">atalk/afp.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="cnid_8h_source.html">atalk/cnid.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="errchk_8h_source.html">atalk/errchk.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="fce__api_8h_source.html">atalk/fce_api.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="globals_8h_source.html">atalk/globals.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="logger_8h_source.html">atalk/logger.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="netatalk__conf_8h_source.html">atalk/netatalk_conf.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="include_2atalk_2unix_8h_source.html">atalk/unix.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="include_2atalk_2util_8h_source.html">atalk/util.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="uuid_8h_source.html">atalk/uuid.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="vfs_8h_source.html">atalk/vfs.h</a>&gt;</code><br />
<code>#include &quot;<a class="el" href="desktop_8h_source.html">desktop.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="dircache_8h_source.html">dircache.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="etc_2afpd_2directory_8h_source.html">directory.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="afpd_2file_8h_source.html">file.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="filedir_8h_source.html">filedir.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="fork_8h_source.html">fork.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="etc_2afpd_2hash_8h_source.html">hash.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mangle_8h_source.html">mangle.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="etc_2afpd_2unix_8h_source.html">unix.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="etc_2afpd_2volume_8h_source.html">volume.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a5ff31de4779fc26d27462c7bd9c8908a" id="r_a5ff31de4779fc26d27462c7bd9c8908a"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5ff31de4779fc26d27462c7bd9c8908a">netatalk_mkdir</a> (const struct <a class="el" href="structvol.html">vol</a> *<a class="el" href="structvol.html">vol</a>, const char *name)</td></tr>
<tr class="memitem:ac2a58ee018272827dcd184a64645a5f6" id="r_ac2a58ee018272827dcd184a64645a5f6"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac2a58ee018272827dcd184a64645a5f6">deletedir</a> (const struct <a class="el" href="structvol.html">vol</a> *<a class="el" href="structvol.html">vol</a>, int dirfd, char *<a class="el" href="structdir.html">dir</a>)</td></tr>
<tr class="memitem:a7d1b484dda8f1ed58e19332e27067f5a" id="r_a7d1b484dda8f1ed58e19332e27067f5a"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7d1b484dda8f1ed58e19332e27067f5a">copydir</a> (struct <a class="el" href="structvol.html">vol</a> *<a class="el" href="structvol.html">vol</a>, struct <a class="el" href="structdir.html">dir</a> *ddir, int dirfd, char *src, char *dst)</td></tr>
<tr class="memitem:a65d9d789bf055427e09071cc5cef2ed8" id="r_a65d9d789bf055427e09071cc5cef2ed8"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a65d9d789bf055427e09071cc5cef2ed8">diroffcnt</a> (struct <a class="el" href="structdir.html">dir</a> *<a class="el" href="structdir.html">dir</a>, struct stat *st)</td></tr>
<tr class="memitem:a4001844c5eeebd68d94604a7bfe6cda7" id="r_a4001844c5eeebd68d94604a7bfe6cda7"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4001844c5eeebd68d94604a7bfe6cda7">invisible_dots</a> (const struct <a class="el" href="structvol.html">vol</a> *<a class="el" href="structvol.html">vol</a>, const char *name)</td></tr>
<tr class="memitem:a34da439c0e7ff71b40924fd8551d5476" id="r_a34da439c0e7ff71b40924fd8551d5476"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a34da439c0e7ff71b40924fd8551d5476">set_dir_errors</a> (struct <a class="el" href="structpath.html">path</a> *<a class="el" href="structpath.html">path</a>, const char *where, int err)</td></tr>
<tr class="memitem:a6027a489bc3a63c8408a3b04dc31f225" id="r_a6027a489bc3a63c8408a3b04dc31f225"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6027a489bc3a63c8408a3b04dc31f225">cname_mtouname</a> (const struct <a class="el" href="structvol.html">vol</a> *<a class="el" href="structvol.html">vol</a>, struct <a class="el" href="structdir.html">dir</a> *<a class="el" href="structdir.html">dir</a>, struct <a class="el" href="structpath.html">path</a> *ret, int toUTF8)</td></tr>
<tr class="memdesc:a6027a489bc3a63c8408a3b04dc31f225"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert name in client encoding to server encoding.  <br /></td></tr>
<tr class="memitem:aae1a9489c4b2df2d2b80ff2e42cd594b" id="r_aae1a9489c4b2df2d2b80ff2e42cd594b"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structpath.html">path</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aae1a9489c4b2df2d2b80ff2e42cd594b">path_from_dir</a> (struct <a class="el" href="structvol.html">vol</a> *<a class="el" href="structvol.html">vol</a>, struct <a class="el" href="structdir.html">dir</a> *<a class="el" href="structdir.html">dir</a>, struct <a class="el" href="structpath.html">path</a> *ret)</td></tr>
<tr class="memdesc:aae1a9489c4b2df2d2b80ff2e42cd594b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Build struct path from struct dir.  <br /></td></tr>
<tr class="memitem:a2f08e97a51b5a57276f6a8c7444dd357" id="r_a2f08e97a51b5a57276f6a8c7444dd357"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2f08e97a51b5a57276f6a8c7444dd357">get_afp_errno</a> (const int <a class="el" href="structparam.html">param</a>)</td></tr>
<tr class="memitem:a1d42d13b8257907a411a2704e37dfe93" id="r_a1d42d13b8257907a411a2704e37dfe93"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structdir.html">dir</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1d42d13b8257907a411a2704e37dfe93">dirlookup</a> (const struct <a class="el" href="structvol.html">vol</a> *<a class="el" href="structvol.html">vol</a>, <a class="el" href="adouble_8h.html#aef0c7a006ff504f92f04b55e14c27422">cnid_t</a> <a class="el" href="nad__cp_8c.html#a39466504497f1ab95465d7daf62514c1">did</a>)</td></tr>
<tr class="memdesc:a1d42d13b8257907a411a2704e37dfe93"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resolve a DID.  <br /></td></tr>
<tr class="memitem:a644916c3887056adc8a5d28505f488f4" id="r_a644916c3887056adc8a5d28505f488f4"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structdir.html">dir</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a644916c3887056adc8a5d28505f488f4">dir_new</a> (const char *m_name, const char *u_name, const struct <a class="el" href="structvol.html">vol</a> *<a class="el" href="structvol.html">vol</a>, <a class="el" href="adouble_8h.html#aef0c7a006ff504f92f04b55e14c27422">cnid_t</a> <a class="el" href="nad__cp_8c.html#aed7077a729bc2cf6b1fedd3ce58331a6">pdid</a>, <a class="el" href="adouble_8h.html#aef0c7a006ff504f92f04b55e14c27422">cnid_t</a> <a class="el" href="nad__cp_8c.html#a39466504497f1ab95465d7daf62514c1">did</a>, <a class="el" href="bstrlib_8h.html#a7ee510452ae810b71268dfa7b39a3712">bstring</a> <a class="el" href="structpath.html">path</a>, struct stat *st)</td></tr>
<tr class="memdesc:a644916c3887056adc8a5d28505f488f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct struct dir.  <br /></td></tr>
<tr class="memitem:a273dba2fb5d492e91b9bdfa667e5387e" id="r_a273dba2fb5d492e91b9bdfa667e5387e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a273dba2fb5d492e91b9bdfa667e5387e">dir_free</a> (struct <a class="el" href="structdir.html">dir</a> *<a class="el" href="structdir.html">dir</a>)</td></tr>
<tr class="memdesc:a273dba2fb5d492e91b9bdfa667e5387e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Free a struct dir and all its members.  <br /></td></tr>
<tr class="memitem:ad4203a175074d5440643ce9ac1fd3092" id="r_ad4203a175074d5440643ce9ac1fd3092"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structdir.html">dir</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad4203a175074d5440643ce9ac1fd3092">dir_add</a> (struct <a class="el" href="structvol.html">vol</a> *<a class="el" href="structvol.html">vol</a>, const struct <a class="el" href="structdir.html">dir</a> *<a class="el" href="structdir.html">dir</a>, struct <a class="el" href="structpath.html">path</a> *<a class="el" href="structpath.html">path</a>, int len)</td></tr>
<tr class="memdesc:ad4203a175074d5440643ce9ac1fd3092"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create struct dir from struct path.  <br /></td></tr>
<tr class="memitem:a26f60139d7ddb55a95b0d9ca862afece" id="r_a26f60139d7ddb55a95b0d9ca862afece"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a26f60139d7ddb55a95b0d9ca862afece">dir_free_invalid_q</a> (void)</td></tr>
<tr class="memitem:ad9fbc8ab01c3318e8da4a88258e4b68f" id="r_ad9fbc8ab01c3318e8da4a88258e4b68f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad9fbc8ab01c3318e8da4a88258e4b68f">dir_remove</a> (const struct <a class="el" href="structvol.html">vol</a> *<a class="el" href="structvol.html">vol</a>, struct <a class="el" href="structdir.html">dir</a> *<a class="el" href="structdir.html">dir</a>)</td></tr>
<tr class="memdesc:ad9fbc8ab01c3318e8da4a88258e4b68f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove a file/directory from dircache.  <br /></td></tr>
<tr class="memitem:a27d7b5a570e9482afe6b8b66b436f53f" id="r_a27d7b5a570e9482afe6b8b66b436f53f"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structpath.html">path</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a27d7b5a570e9482afe6b8b66b436f53f">cname</a> (struct <a class="el" href="structvol.html">vol</a> *<a class="el" href="structvol.html">vol</a>, struct <a class="el" href="structdir.html">dir</a> *<a class="el" href="structdir.html">dir</a>, char **cpath)</td></tr>
<tr class="memdesc:a27d7b5a570e9482afe6b8b66b436f53f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resolve a catalog node name path.  <br /></td></tr>
<tr class="memitem:a5925bf05d5c8936f589eb204333ac383" id="r_a5925bf05d5c8936f589eb204333ac383"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5925bf05d5c8936f589eb204333ac383">movecwd</a> (const struct <a class="el" href="structvol.html">vol</a> *<a class="el" href="structvol.html">vol</a>, struct <a class="el" href="structdir.html">dir</a> *<a class="el" href="structdir.html">dir</a>)</td></tr>
<tr class="memitem:a61505d8c1d2da0f511a57da46baabc59" id="r_a61505d8c1d2da0f511a57da46baabc59"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a61505d8c1d2da0f511a57da46baabc59">check_access</a> (const <a class="el" href="struct_a_f_p_obj.html">AFPObj</a> *<a class="el" href="netatalk_8c.html#ab2a2323b2013b68132e8db8dc5087da6">obj</a>, struct <a class="el" href="structvol.html">vol</a> *<a class="el" href="structvol.html">vol</a>, char *<a class="el" href="structpath.html">path</a>, int mode)</td></tr>
<tr class="memitem:a1c034d115ffd2f6219c15cc7bcabc32c" id="r_a1c034d115ffd2f6219c15cc7bcabc32c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1c034d115ffd2f6219c15cc7bcabc32c">file_access</a> (const <a class="el" href="struct_a_f_p_obj.html">AFPObj</a> *<a class="el" href="netatalk_8c.html#ab2a2323b2013b68132e8db8dc5087da6">obj</a>, struct <a class="el" href="structvol.html">vol</a> *<a class="el" href="structvol.html">vol</a>, struct <a class="el" href="structpath.html">path</a> *<a class="el" href="structpath.html">path</a>, int mode)</td></tr>
<tr class="memitem:aa22676a20516192cf6f49bae2add29db" id="r_aa22676a20516192cf6f49bae2add29db"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa22676a20516192cf6f49bae2add29db">setdiroffcnt</a> (struct <a class="el" href="structdir.html">dir</a> *<a class="el" href="structdir.html">dir</a>, struct stat *st, uint32_t count)</td></tr>
<tr class="memitem:a7455b5ea2e7a8383a0d3da4e33414882" id="r_a7455b5ea2e7a8383a0d3da4e33414882"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7455b5ea2e7a8383a0d3da4e33414882">dirreenumerate</a> (struct <a class="el" href="structdir.html">dir</a> *<a class="el" href="structdir.html">dir</a>, struct stat *st)</td></tr>
<tr class="memitem:ad86beed07a8111c83b1372c845c7f675" id="r_ad86beed07a8111c83b1372c845c7f675"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad86beed07a8111c83b1372c845c7f675">getdirparams</a> (const <a class="el" href="struct_a_f_p_obj.html">AFPObj</a> *<a class="el" href="netatalk_8c.html#ab2a2323b2013b68132e8db8dc5087da6">obj</a>, const struct <a class="el" href="structvol.html">vol</a> *<a class="el" href="structvol.html">vol</a>, uint16_t bitmap, struct <a class="el" href="structpath.html">path</a> *s_path, struct <a class="el" href="structdir.html">dir</a> *<a class="el" href="structdir.html">dir</a>, char *<a class="el" href="afppasswd_8c.html#a72dff57571064f4e3546a2bf18e1147d">buf</a>, size_t *buflen)</td></tr>
<tr class="memitem:acff49b6bd0a34aa7106b1ad58affe0b3" id="r_acff49b6bd0a34aa7106b1ad58affe0b3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acff49b6bd0a34aa7106b1ad58affe0b3">path_error</a> (struct <a class="el" href="structpath.html">path</a> *<a class="el" href="structpath.html">path</a>, int error)</td></tr>
<tr class="memitem:a4f96eb29a990866f9ccf312a399eaa85" id="r_a4f96eb29a990866f9ccf312a399eaa85"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4f96eb29a990866f9ccf312a399eaa85">afp_setdirparams</a> (<a class="el" href="struct_a_f_p_obj.html">AFPObj</a> *<a class="el" href="netatalk_8c.html#ab2a2323b2013b68132e8db8dc5087da6">obj</a>, char *ibuf, size_t ibuflen <a class="el" href="cmd__dbd__scanvol_8c.html#a8fa487913fdb31da1be2f0b18ece0755">_U_</a>, char *<a class="el" href="afpfunc__helpers_8c.html#ad50ea93b82541b4008d5b84f255a346b">rbuf</a> <a class="el" href="cmd__dbd__scanvol_8c.html#a8fa487913fdb31da1be2f0b18ece0755">_U_</a>, size_t *<a class="el" href="afpfunc__helpers_8c.html#a7871fd1d66c15c2c744bd28109af4631">rbuflen</a>)</td></tr>
<tr class="memitem:a7bac9da0f32775d518f404c6eab23417" id="r_a7bac9da0f32775d518f404c6eab23417"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7bac9da0f32775d518f404c6eab23417">setdirparams</a> (struct <a class="el" href="structvol.html">vol</a> *<a class="el" href="structvol.html">vol</a>, struct <a class="el" href="structpath.html">path</a> *<a class="el" href="structpath.html">path</a>, uint16_t d_bitmap, char *<a class="el" href="afppasswd_8c.html#a72dff57571064f4e3546a2bf18e1147d">buf</a>)</td></tr>
<tr class="memitem:ad385955134a295f068f000f202770d9f" id="r_ad385955134a295f068f000f202770d9f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad385955134a295f068f000f202770d9f">afp_syncdir</a> (<a class="el" href="struct_a_f_p_obj.html">AFPObj</a> *<a class="el" href="netatalk_8c.html#ab2a2323b2013b68132e8db8dc5087da6">obj</a> <a class="el" href="cmd__dbd__scanvol_8c.html#a8fa487913fdb31da1be2f0b18ece0755">_U_</a>, char *ibuf, size_t ibuflen <a class="el" href="cmd__dbd__scanvol_8c.html#a8fa487913fdb31da1be2f0b18ece0755">_U_</a>, char *<a class="el" href="afpfunc__helpers_8c.html#ad50ea93b82541b4008d5b84f255a346b">rbuf</a> <a class="el" href="cmd__dbd__scanvol_8c.html#a8fa487913fdb31da1be2f0b18ece0755">_U_</a>, size_t *<a class="el" href="afpfunc__helpers_8c.html#a7871fd1d66c15c2c744bd28109af4631">rbuflen</a>)</td></tr>
<tr class="memitem:a50a672551446dd52e3804311300e5a2f" id="r_a50a672551446dd52e3804311300e5a2f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a50a672551446dd52e3804311300e5a2f">afp_createdir</a> (<a class="el" href="struct_a_f_p_obj.html">AFPObj</a> *<a class="el" href="netatalk_8c.html#ab2a2323b2013b68132e8db8dc5087da6">obj</a>, char *ibuf, size_t ibuflen <a class="el" href="cmd__dbd__scanvol_8c.html#a8fa487913fdb31da1be2f0b18ece0755">_U_</a>, char *<a class="el" href="afpfunc__helpers_8c.html#ad50ea93b82541b4008d5b84f255a346b">rbuf</a>, size_t *<a class="el" href="afpfunc__helpers_8c.html#a7871fd1d66c15c2c744bd28109af4631">rbuflen</a>)</td></tr>
<tr class="memitem:a6bb6e6110b332a0a59ee3093f08025b0" id="r_a6bb6e6110b332a0a59ee3093f08025b0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6bb6e6110b332a0a59ee3093f08025b0">renamedir</a> (struct <a class="el" href="structvol.html">vol</a> *<a class="el" href="structvol.html">vol</a>, int dirfd, char *src, char *dst, struct <a class="el" href="structdir.html">dir</a> *newparent, char *newname)</td></tr>
<tr class="memitem:abdc3efb68d9e433fd85541bcb4f3dd29" id="r_abdc3efb68d9e433fd85541bcb4f3dd29"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abdc3efb68d9e433fd85541bcb4f3dd29">deletecurdir</a> (struct <a class="el" href="structvol.html">vol</a> *<a class="el" href="structvol.html">vol</a>)</td></tr>
<tr class="memitem:ae01afd79c7063f0e563684669573ac04" id="r_ae01afd79c7063f0e563684669573ac04"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae01afd79c7063f0e563684669573ac04">afp_mapid</a> (<a class="el" href="struct_a_f_p_obj.html">AFPObj</a> *<a class="el" href="netatalk_8c.html#ab2a2323b2013b68132e8db8dc5087da6">obj</a>, char *ibuf, size_t ibuflen <a class="el" href="cmd__dbd__scanvol_8c.html#a8fa487913fdb31da1be2f0b18ece0755">_U_</a>, char *<a class="el" href="afpfunc__helpers_8c.html#ad50ea93b82541b4008d5b84f255a346b">rbuf</a>, size_t *<a class="el" href="afpfunc__helpers_8c.html#a7871fd1d66c15c2c744bd28109af4631">rbuflen</a>)</td></tr>
<tr class="memitem:ac4555876f44d424cdb9e29e6aa1ccb16" id="r_ac4555876f44d424cdb9e29e6aa1ccb16"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac4555876f44d424cdb9e29e6aa1ccb16">afp_mapname</a> (<a class="el" href="struct_a_f_p_obj.html">AFPObj</a> *<a class="el" href="netatalk_8c.html#ab2a2323b2013b68132e8db8dc5087da6">obj</a>, char *ibuf, size_t ibuflen <a class="el" href="cmd__dbd__scanvol_8c.html#a8fa487913fdb31da1be2f0b18ece0755">_U_</a>, char *<a class="el" href="afpfunc__helpers_8c.html#ad50ea93b82541b4008d5b84f255a346b">rbuf</a>, size_t *<a class="el" href="afpfunc__helpers_8c.html#a7871fd1d66c15c2c744bd28109af4631">rbuflen</a>)</td></tr>
<tr class="memitem:a8852a2e38c5fdaf1cf49ec280e39f796" id="r_a8852a2e38c5fdaf1cf49ec280e39f796"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8852a2e38c5fdaf1cf49ec280e39f796">afp_closedir</a> (<a class="el" href="struct_a_f_p_obj.html">AFPObj</a> *<a class="el" href="netatalk_8c.html#ab2a2323b2013b68132e8db8dc5087da6">obj</a> <a class="el" href="cmd__dbd__scanvol_8c.html#a8fa487913fdb31da1be2f0b18ece0755">_U_</a>, char *ibuf <a class="el" href="cmd__dbd__scanvol_8c.html#a8fa487913fdb31da1be2f0b18ece0755">_U_</a>, size_t ibuflen <a class="el" href="cmd__dbd__scanvol_8c.html#a8fa487913fdb31da1be2f0b18ece0755">_U_</a>, char *<a class="el" href="afpfunc__helpers_8c.html#ad50ea93b82541b4008d5b84f255a346b">rbuf</a> <a class="el" href="cmd__dbd__scanvol_8c.html#a8fa487913fdb31da1be2f0b18ece0755">_U_</a>, size_t *<a class="el" href="afpfunc__helpers_8c.html#a7871fd1d66c15c2c744bd28109af4631">rbuflen</a>)</td></tr>
<tr class="memitem:a6f49298622ae1e89538b70344036451d" id="r_a6f49298622ae1e89538b70344036451d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6f49298622ae1e89538b70344036451d">afp_opendir</a> (<a class="el" href="struct_a_f_p_obj.html">AFPObj</a> *<a class="el" href="netatalk_8c.html#ab2a2323b2013b68132e8db8dc5087da6">obj</a> <a class="el" href="cmd__dbd__scanvol_8c.html#a8fa487913fdb31da1be2f0b18ece0755">_U_</a>, char *ibuf, size_t ibuflen <a class="el" href="cmd__dbd__scanvol_8c.html#a8fa487913fdb31da1be2f0b18ece0755">_U_</a>, char *<a class="el" href="afpfunc__helpers_8c.html#ad50ea93b82541b4008d5b84f255a346b">rbuf</a>, size_t *<a class="el" href="afpfunc__helpers_8c.html#a7871fd1d66c15c2c744bd28109af4631">rbuflen</a>)</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-var-members" class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a09cb8e56fefa586697966b74babc0215" id="r_a09cb8e56fefa586697966b74babc0215"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a09cb8e56fefa586697966b74babc0215">afp_errno</a></td></tr>
<tr class="memitem:afc074b4ee505bd5e3a26534ecf1c0bb5" id="r_afc074b4ee505bd5e3a26534ecf1c0bb5"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structdir.html">dir</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afc074b4ee505bd5e3a26534ecf1c0bb5">rootParent</a></td></tr>
<tr class="memitem:a088baac204c8a286625ad46531212f33" id="r_a088baac204c8a286625ad46531212f33"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structdir.html">dir</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a088baac204c8a286625ad46531212f33">curdir</a> = &amp;<a class="el" href="#afc074b4ee505bd5e3a26534ecf1c0bb5">rootParent</a></td></tr>
<tr class="memitem:acb7bf41a918f181a9da500470e4dcda5" id="r_acb7bf41a918f181a9da500470e4dcda5"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structpath.html">path</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acb7bf41a918f181a9da500470e4dcda5">Cur_Path</a></td></tr>
<tr class="memitem:aeb00a5666ec47da33ceaf4ca045d96bf" id="r_aeb00a5666ec47da33ceaf4ca045d96bf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="queue_8h.html#a0150f5145b7cc9ec8c12f7c526057ffe">q_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aeb00a5666ec47da33ceaf4ca045d96bf">invalid_dircache_entries</a></td></tr>
</table>
<a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function Documentation</h2>
<a id="a8852a2e38c5fdaf1cf49ec280e39f796" name="a8852a2e38c5fdaf1cf49ec280e39f796"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8852a2e38c5fdaf1cf49ec280e39f796">&#9670;&#160;</a></span>afp_closedir()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int afp_closedir </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_a_f_p_obj.html">AFPObj</a> *<a class="el" href="netatalk_8c.html#ab2a2323b2013b68132e8db8dc5087da6">obj</a></td>          <td class="paramname"><span class="paramname"><em>_U_</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *ibuf</td>          <td class="paramname"><span class="paramname"><em>_U_</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t ibuflen</td>          <td class="paramname"><span class="paramname"><em>_U_</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *<a class="el" href="afpfunc__helpers_8c.html#ad50ea93b82541b4008d5b84f255a346b">rbuf</a></td>          <td class="paramname"><span class="paramname"><em>_U_</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>rbuflen</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a50a672551446dd52e3804311300e5a2f" name="a50a672551446dd52e3804311300e5a2f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50a672551446dd52e3804311300e5a2f">&#9670;&#160;</a></span>afp_createdir()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int afp_createdir </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_a_f_p_obj.html">AFPObj</a> *</td>          <td class="paramname"><span class="paramname"><em>obj</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>ibuf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t ibuflen</td>          <td class="paramname"><span class="paramname"><em>_U_</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>rbuf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>rbuflen</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ae01afd79c7063f0e563684669573ac04" name="ae01afd79c7063f0e563684669573ac04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae01afd79c7063f0e563684669573ac04">&#9670;&#160;</a></span>afp_mapid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int afp_mapid </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_a_f_p_obj.html">AFPObj</a> *</td>          <td class="paramname"><span class="paramname"><em>obj</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>ibuf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t ibuflen</td>          <td class="paramname"><span class="paramname"><em>_U_</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>rbuf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>rbuflen</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac4555876f44d424cdb9e29e6aa1ccb16" name="ac4555876f44d424cdb9e29e6aa1ccb16"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4555876f44d424cdb9e29e6aa1ccb16">&#9670;&#160;</a></span>afp_mapname()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int afp_mapname </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_a_f_p_obj.html">AFPObj</a> *</td>          <td class="paramname"><span class="paramname"><em>obj</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>ibuf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t ibuflen</td>          <td class="paramname"><span class="paramname"><em>_U_</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>rbuf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>rbuflen</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a6f49298622ae1e89538b70344036451d" name="a6f49298622ae1e89538b70344036451d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f49298622ae1e89538b70344036451d">&#9670;&#160;</a></span>afp_opendir()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int afp_opendir </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_a_f_p_obj.html">AFPObj</a> *<a class="el" href="netatalk_8c.html#ab2a2323b2013b68132e8db8dc5087da6">obj</a></td>          <td class="paramname"><span class="paramname"><em>_U_</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>ibuf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t ibuflen</td>          <td class="paramname"><span class="paramname"><em>_U_</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>rbuf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>rbuflen</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a4f96eb29a990866f9ccf312a399eaa85" name="a4f96eb29a990866f9ccf312a399eaa85"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f96eb29a990866f9ccf312a399eaa85">&#9670;&#160;</a></span>afp_setdirparams()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int afp_setdirparams </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_a_f_p_obj.html">AFPObj</a> *</td>          <td class="paramname"><span class="paramname"><em>obj</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>ibuf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t ibuflen</td>          <td class="paramname"><span class="paramname"><em>_U_</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *<a class="el" href="afpfunc__helpers_8c.html#ad50ea93b82541b4008d5b84f255a346b">rbuf</a></td>          <td class="paramname"><span class="paramname"><em>_U_</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>rbuflen</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ad385955134a295f068f000f202770d9f" name="ad385955134a295f068f000f202770d9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad385955134a295f068f000f202770d9f">&#9670;&#160;</a></span>afp_syncdir()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int afp_syncdir </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_a_f_p_obj.html">AFPObj</a> *<a class="el" href="netatalk_8c.html#ab2a2323b2013b68132e8db8dc5087da6">obj</a></td>          <td class="paramname"><span class="paramname"><em>_U_</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>ibuf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t ibuflen</td>          <td class="paramname"><span class="paramname"><em>_U_</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *<a class="el" href="afpfunc__helpers_8c.html#ad50ea93b82541b4008d5b84f255a346b">rbuf</a></td>          <td class="paramname"><span class="paramname"><em>_U_</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>rbuflen</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a61505d8c1d2da0f511a57da46baabc59" name="a61505d8c1d2da0f511a57da46baabc59"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61505d8c1d2da0f511a57da46baabc59">&#9670;&#160;</a></span>check_access()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int check_access </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_a_f_p_obj.html">AFPObj</a> *</td>          <td class="paramname"><span class="paramname"><em>obj</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structvol.html">vol</a> *</td>          <td class="paramname"><span class="paramname"><em>vol</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>path</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>mode</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a27d7b5a570e9482afe6b8b66b436f53f" name="a27d7b5a570e9482afe6b8b66b436f53f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27d7b5a570e9482afe6b8b66b436f53f">&#9670;&#160;</a></span>cname()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structpath.html">path</a> * cname </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvol.html">vol</a> *</td>          <td class="paramname"><span class="paramname"><em>vol</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structdir.html">dir</a> *</td>          <td class="paramname"><span class="paramname"><em>dir</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **</td>          <td class="paramname"><span class="paramname"><em>cpath</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Resolve a catalog node name path. </p>
<ol type="1">
<li>Evaluate path type</li>
<li>Move to start dir, if we can't, it might be e.g. because of EACCES, build path from dirname, so e.g. getdirparams has sth it can chew on. curdir is dir parent then. All this is done in <a class="el" href="#aae1a9489c4b2df2d2b80ff2e42cd594b" title="Build struct path from struct dir.">path_from_dir()</a>.</li>
<li>Parse next cnode name in path, cases:</li>
<li>single "\0" -&gt; do nothing</li>
<li>two or more consecutive "\0" -&gt; chdir("..") one or more times</li>
<li>cnode name -&gt; copy it to <a class="el" href="structpath.html#ad8edd560cafe7fa8232fb126eaf09aa0">path.m_name</a></li>
<li>Get unix name from mac name</li>
<li>Special handling of request with did 1</li>
<li>stat the cnode name</li>
<li>If it's not there, it's probably an afp_createfile|dir, return with curdir = dir parent, struct path = dirname</li>
<li>If it's there and it's a file, it must should be the last element of the requested path. Return with curdir = cnode name parent dir, struct path = filename</li>
<li>Treat symlinks like files, don't follow them</li>
<li>If it's a dir:</li>
<li>Search the dircache for it</li>
<li>If it's not in the cache, create a struct dir for it and add it to the cache</li>
<li>chdir into the dir and</li>
<li>set m_name to the mac equivalent of "."</li>
<li>goto 3 </li>
</ol>

</div>
</div>
<a id="a6027a489bc3a63c8408a3b04dc31f225" name="a6027a489bc3a63c8408a3b04dc31f225"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6027a489bc3a63c8408a3b04dc31f225">&#9670;&#160;</a></span>cname_mtouname()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int cname_mtouname </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structvol.html">vol</a> *</td>          <td class="paramname"><span class="paramname"><em>vol</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structdir.html">dir</a> *</td>          <td class="paramname"><span class="paramname"><em>dir</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structpath.html">path</a> *</td>          <td class="paramname"><span class="paramname"><em>ret</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>toUTF8</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Convert name in client encoding to server encoding. </p>
<p>Convert ret-&gt;m_name to ret-&gt;u_name from client encoding to server encoding. This only gets called from <a class="el" href="#a27d7b5a570e9482afe6b8b66b436f53f" title="Resolve a catalog node name path.">cname()</a>.</p>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 on error</dd></dl>
<dl class="section note"><dt>Note</dt><dd>If the passed ret-&gt;m_name is mangled, we'll demangle it </dd></dl>

</div>
</div>
<a id="a7d1b484dda8f1ed58e19332e27067f5a" name="a7d1b484dda8f1ed58e19332e27067f5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d1b484dda8f1ed58e19332e27067f5a">&#9670;&#160;</a></span>copydir()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int copydir </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvol.html">vol</a> *</td>          <td class="paramname"><span class="paramname"><em>vol</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structdir.html">dir</a> *</td>          <td class="paramname"><span class="paramname"><em>ddir</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>dirfd</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>src</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>dst</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="abdc3efb68d9e433fd85541bcb4f3dd29" name="abdc3efb68d9e433fd85541bcb4f3dd29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abdc3efb68d9e433fd85541bcb4f3dd29">&#9670;&#160;</a></span>deletecurdir()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int deletecurdir </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvol.html">vol</a> *</td>          <td class="paramname"><span class="paramname"><em>vol</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac2a58ee018272827dcd184a64645a5f6" name="ac2a58ee018272827dcd184a64645a5f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2a58ee018272827dcd184a64645a5f6">&#9670;&#160;</a></span>deletedir()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int deletedir </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structvol.html">vol</a> *</td>          <td class="paramname"><span class="paramname"><em>vol</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>dirfd</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>dir</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ad4203a175074d5440643ce9ac1fd3092" name="ad4203a175074d5440643ce9ac1fd3092"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4203a175074d5440643ce9ac1fd3092">&#9670;&#160;</a></span>dir_add()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structdir.html">dir</a> * dir_add </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvol.html">vol</a> *</td>          <td class="paramname"><span class="paramname"><em>vol</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structdir.html">dir</a> *</td>          <td class="paramname"><span class="paramname"><em>dir</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structpath.html">path</a> *</td>          <td class="paramname"><span class="paramname"><em>path</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create struct dir from struct path. </p>
<p>Create a new struct dir from struct path. Then add it to the cache.</p>
<ol type="1">
<li>Open adouble file, get CNID from it.</li>
<li>Search the database, hinting with the CNID from (1).</li>
<li>Build fullpath and create struct dir.</li>
<li>Add it to the cache.</li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">vol</td><td>(r) pointer to struct vol, possibly modified in callee </td></tr>
    <tr><td class="paramname">dir</td><td>(r) pointer to parent directory </td></tr>
    <tr><td class="paramname">path</td><td>(rw) pointer to struct path with valid path-&gt;u_name </td></tr>
    <tr><td class="paramname">len</td><td>(r) strlen of path-&gt;u_name</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to new struct dir or NULL on error.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Function also assigns path-&gt;m_name from path-&gt;u_name. </dd></dl>

</div>
</div>
<a id="a273dba2fb5d492e91b9bdfa667e5387e" name="a273dba2fb5d492e91b9bdfa667e5387e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a273dba2fb5d492e91b9bdfa667e5387e">&#9670;&#160;</a></span>dir_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dir_free </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structdir.html">dir</a> *</td>          <td class="paramname"><span class="paramname"><em>dir</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Free a struct dir and all its members. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dir</td><td>(rw) pointer to struct dir </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a26f60139d7ddb55a95b0d9ca862afece" name="a26f60139d7ddb55a95b0d9ca862afece"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26f60139d7ddb55a95b0d9ca862afece">&#9670;&#160;</a></span>dir_free_invalid_q()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dir_free_invalid_q </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Free the queue with invalid struct dirs</p>
<p>This gets called at the end of every AFP func. </p>

</div>
</div>
<a id="a644916c3887056adc8a5d28505f488f4" name="a644916c3887056adc8a5d28505f488f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a644916c3887056adc8a5d28505f488f4">&#9670;&#160;</a></span>dir_new()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structdir.html">dir</a> * dir_new </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>m_name</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>u_name</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structvol.html">vol</a> *</td>          <td class="paramname"><span class="paramname"><em>vol</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="adouble_8h.html#aef0c7a006ff504f92f04b55e14c27422">cnid_t</a></td>          <td class="paramname"><span class="paramname"><em>pdid</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="adouble_8h.html#aef0c7a006ff504f92f04b55e14c27422">cnid_t</a></td>          <td class="paramname"><span class="paramname"><em>did</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bstrlib_8h.html#a7ee510452ae810b71268dfa7b39a3712">bstring</a></td>          <td class="paramname"><span class="paramname"><em>path</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct stat *</td>          <td class="paramname"><span class="paramname"><em>st</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Construct struct dir. </p>
<p>Construct struct dir from parameters.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">m_name</td><td>(r) directory name in UTF8-dec </td></tr>
    <tr><td class="paramname">u_name</td><td>(r) directory name in server side encoding </td></tr>
    <tr><td class="paramname">vol</td><td>(r) pointer to struct vol </td></tr>
    <tr><td class="paramname">pdid</td><td>(r) Parent CNID </td></tr>
    <tr><td class="paramname">did</td><td>(r) CNID </td></tr>
    <tr><td class="paramname">path</td><td>(r) Full unix path to object </td></tr>
    <tr><td class="paramname">st</td><td>(r) struct stat of object</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>pointer to new struct dir or NULL on error</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Most of the time mac name and unix name are the same. </dd></dl>

</div>
</div>
<a id="ad9fbc8ab01c3318e8da4a88258e4b68f" name="ad9fbc8ab01c3318e8da4a88258e4b68f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9fbc8ab01c3318e8da4a88258e4b68f">&#9670;&#160;</a></span>dir_remove()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dir_remove </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structvol.html">vol</a> *</td>          <td class="paramname"><span class="paramname"><em>vol</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structdir.html">dir</a> *</td>          <td class="paramname"><span class="paramname"><em>dir</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove a file/directory from dircache. </p>
<ol type="1">
<li>Check the dir</li>
<li>Remove it from the cache</li>
<li>Queue it for removal</li>
<li>If it's a request to remove curdir, mark curdir as invalid</li>
<li>Mark it as invalid</li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">vol</td><td>(r) volume pointer </td></tr>
    <tr><td class="paramname">dir</td><td>(rw) directory/file entry to remove from cache </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success </dd></dl>

</div>
</div>
<a id="a1d42d13b8257907a411a2704e37dfe93" name="a1d42d13b8257907a411a2704e37dfe93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d42d13b8257907a411a2704e37dfe93">&#9670;&#160;</a></span>dirlookup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structdir.html">dir</a> * dirlookup </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structvol.html">vol</a> *</td>          <td class="paramname"><span class="paramname"><em>vol</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="adouble_8h.html#aef0c7a006ff504f92f04b55e14c27422">cnid_t</a></td>          <td class="paramname"><span class="paramname"><em>did</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Resolve a DID. </p>
<p>Resolve a DID, allocate a struct dir for it</p><ol type="1">
<li>Check for special CNIDs 0 (invalid), 1 and 2. 2a. Check if the DID is in the cache. 2b. Check if it's really a dir because we cache files too.</li>
<li>If it's not in the cache resolve it via the database.</li>
<li>Build complete server-side path to the dir.</li>
<li>Check if it exists and is a directory.</li>
<li>Create the struct dir and populate it.</li>
<li>Add it to the cache.</li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">vol</td><td>(r) pointer to struct vol </td></tr>
    <tr><td class="paramname">did</td><td>(r) DID to resolve</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>pointer to struct dir </dd></dl>

</div>
</div>
<a id="a65d9d789bf055427e09071cc5cef2ed8" name="a65d9d789bf055427e09071cc5cef2ed8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65d9d789bf055427e09071cc5cef2ed8">&#9670;&#160;</a></span>diroffcnt()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int diroffcnt </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structdir.html">dir</a> *</td>          <td class="paramname"><span class="paramname"><em>dir</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct stat *</td>          <td class="paramname"><span class="paramname"><em>st</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a7455b5ea2e7a8383a0d3da4e33414882" name="a7455b5ea2e7a8383a0d3da4e33414882"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7455b5ea2e7a8383a0d3da4e33414882">&#9670;&#160;</a></span>dirreenumerate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dirreenumerate </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structdir.html">dir</a> *</td>          <td class="paramname"><span class="paramname"><em>dir</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct stat *</td>          <td class="paramname"><span class="paramname"><em>st</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a1c034d115ffd2f6219c15cc7bcabc32c" name="a1c034d115ffd2f6219c15cc7bcabc32c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c034d115ffd2f6219c15cc7bcabc32c">&#9670;&#160;</a></span>file_access()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int file_access </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_a_f_p_obj.html">AFPObj</a> *</td>          <td class="paramname"><span class="paramname"><em>obj</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structvol.html">vol</a> *</td>          <td class="paramname"><span class="paramname"><em>vol</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structpath.html">path</a> *</td>          <td class="paramname"><span class="paramname"><em>path</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>mode</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a2f08e97a51b5a57276f6a8c7444dd357" name="a2f08e97a51b5a57276f6a8c7444dd357"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f08e97a51b5a57276f6a8c7444dd357">&#9670;&#160;</a></span>get_afp_errno()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int get_afp_errno </td>
          <td>(</td>
          <td class="paramtype">const int</td>          <td class="paramname"><span class="paramname"><em>param</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ad86beed07a8111c83b1372c845c7f675" name="ad86beed07a8111c83b1372c845c7f675"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad86beed07a8111c83b1372c845c7f675">&#9670;&#160;</a></span>getdirparams()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int getdirparams </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_a_f_p_obj.html">AFPObj</a> *</td>          <td class="paramname"><span class="paramname"><em>obj</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structvol.html">vol</a> *</td>          <td class="paramname"><span class="paramname"><em>vol</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t</td>          <td class="paramname"><span class="paramname"><em>bitmap</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structpath.html">path</a> *</td>          <td class="paramname"><span class="paramname"><em>s_path</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structdir.html">dir</a> *</td>          <td class="paramname"><span class="paramname"><em>dir</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>buf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>buflen</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a4001844c5eeebd68d94604a7bfe6cda7" name="a4001844c5eeebd68d94604a7bfe6cda7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4001844c5eeebd68d94604a7bfe6cda7">&#9670;&#160;</a></span>invisible_dots()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int invisible_dots </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structvol.html">vol</a> *</td>          <td class="paramname"><span class="paramname"><em>vol</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>name</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a5925bf05d5c8936f589eb204333ac383" name="a5925bf05d5c8936f589eb204333ac383"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5925bf05d5c8936f589eb204333ac383">&#9670;&#160;</a></span>movecwd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int movecwd </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structvol.html">vol</a> *</td>          <td class="paramname"><span class="paramname"><em>vol</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structdir.html">dir</a> *</td>          <td class="paramname"><span class="paramname"><em>dir</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a5ff31de4779fc26d27462c7bd9c8908a" name="a5ff31de4779fc26d27462c7bd9c8908a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ff31de4779fc26d27462c7bd9c8908a">&#9670;&#160;</a></span>netatalk_mkdir()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int netatalk_mkdir </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structvol.html">vol</a> *</td>          <td class="paramname"><span class="paramname"><em>vol</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>name</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="acff49b6bd0a34aa7106b1ad58affe0b3" name="acff49b6bd0a34aa7106b1ad58affe0b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acff49b6bd0a34aa7106b1ad58affe0b3">&#9670;&#160;</a></span>path_error()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int path_error </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structpath.html">path</a> *</td>          <td class="paramname"><span class="paramname"><em>path</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>error</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aae1a9489c4b2df2d2b80ff2e42cd594b" name="aae1a9489c4b2df2d2b80ff2e42cd594b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae1a9489c4b2df2d2b80ff2e42cd594b">&#9670;&#160;</a></span>path_from_dir()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structpath.html">path</a> * path_from_dir </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvol.html">vol</a> *</td>          <td class="paramname"><span class="paramname"><em>vol</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structdir.html">dir</a> *</td>          <td class="paramname"><span class="paramname"><em>dir</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structpath.html">path</a> *</td>          <td class="paramname"><span class="paramname"><em>ret</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Build struct path from struct dir. </p>
<p>The final movecwd in cname failed, possibly with EPERM or ENOENT. We:</p><ol type="1">
<li>move cwd into parent dir (we're often already there, but not always)</li>
<li>set struct path to the dirname</li>
<li>in case of AFPERR_ACCESS: the dir is there, we just can't chdir into it AFPERR_NOOBJ: the dir was there when we stated it in cname, so we have a race<ol type="a">
<li>indicate there's no dir for this path</li>
<li>remove the dir </li>
</ol>
</li>
</ol>

</div>
</div>
<a id="a6bb6e6110b332a0a59ee3093f08025b0" name="a6bb6e6110b332a0a59ee3093f08025b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6bb6e6110b332a0a59ee3093f08025b0">&#9670;&#160;</a></span>renamedir()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int renamedir </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvol.html">vol</a> *</td>          <td class="paramname"><span class="paramname"><em>vol</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>dirfd</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>src</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>dst</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structdir.html">dir</a> *</td>          <td class="paramname"><span class="paramname"><em>newparent</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>newname</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a34da439c0e7ff71b40924fd8551d5476" name="a34da439c0e7ff71b40924fd8551d5476"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34da439c0e7ff71b40924fd8551d5476">&#9670;&#160;</a></span>set_dir_errors()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int set_dir_errors </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structpath.html">path</a> *</td>          <td class="paramname"><span class="paramname"><em>path</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>where</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>err</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aa22676a20516192cf6f49bae2add29db" name="aa22676a20516192cf6f49bae2add29db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa22676a20516192cf6f49bae2add29db">&#9670;&#160;</a></span>setdiroffcnt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setdiroffcnt </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structdir.html">dir</a> *</td>          <td class="paramname"><span class="paramname"><em>dir</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct stat *</td>          <td class="paramname"><span class="paramname"><em>st</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>count</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a7bac9da0f32775d518f404c6eab23417" name="a7bac9da0f32775d518f404c6eab23417"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7bac9da0f32775d518f404c6eab23417">&#9670;&#160;</a></span>setdirparams()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int setdirparams </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structvol.html">vol</a> *</td>          <td class="paramname"><span class="paramname"><em>vol</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structpath.html">path</a> *</td>          <td class="paramname"><span class="paramname"><em>path</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t</td>          <td class="paramname"><span class="paramname"><em>d_bitmap</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>buf</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a name="doc-var-members" id="doc-var-members"></a><h2 id="header-doc-var-members" class="groupheader">Variable Documentation</h2>
<a id="a09cb8e56fefa586697966b74babc0215" name="a09cb8e56fefa586697966b74babc0215"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09cb8e56fefa586697966b74babc0215">&#9670;&#160;</a></span>afp_errno</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int afp_errno</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="acb7bf41a918f181a9da500470e4dcda5" name="acb7bf41a918f181a9da500470e4dcda5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb7bf41a918f181a9da500470e4dcda5">&#9670;&#160;</a></span>Cur_Path</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structpath.html">path</a> Cur_Path</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    0,</div>
<div class="line">    </div>
<div class="line">    <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">    </div>
<div class="line">    <span class="stringliteral">&quot;.&quot;</span>,</div>
<div class="line">    </div>
<div class="line">    0,</div>
<div class="line">    </div>
<div class="line">    NULL,</div>
<div class="line">    </div>
<div class="line">    0,</div>
<div class="line">    </div>
<div class="line">    0,</div>
<div class="line">    </div>
<div class="line">    {0}</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a088baac204c8a286625ad46531212f33" name="a088baac204c8a286625ad46531212f33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a088baac204c8a286625ad46531212f33">&#9670;&#160;</a></span>curdir</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structdir.html">dir</a>* curdir = &amp;<a class="el" href="#afc074b4ee505bd5e3a26534ecf1c0bb5">rootParent</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aeb00a5666ec47da33ceaf4ca045d96bf" name="aeb00a5666ec47da33ceaf4ca045d96bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb00a5666ec47da33ceaf4ca045d96bf">&#9670;&#160;</a></span>invalid_dircache_entries</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="queue_8h.html#a0150f5145b7cc9ec8c12f7c526057ffe">q_t</a>* invalid_dircache_entries</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="afc074b4ee505bd5e3a26534ecf1c0bb5" name="afc074b4ee505bd5e3a26534ecf1c0bb5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc074b4ee505bd5e3a26534ecf1c0bb5">&#9670;&#160;</a></span>rootParent</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structdir.html">dir</a> rootParent</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    </div>
<div class="line">    NULL, NULL, NULL, NULL,</div>
<div class="line">    </div>
<div class="line">    NULL, 0, 0, 0,</div>
<div class="line">    </div>
<div class="line">    0, 0, 0, 0,</div>
<div class="line">    </div>
<div class="line">    0, 0</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- HTML footer for doxygen 1.14.0-->
<!-- modified for netatalk -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="dir_34c6163d67acbbcfc56107279c411fb1.html">etc</a></li><li class="navelem"><a href="dir_785339ec9791c4184a005bb62f1723d7.html">afpd</a></li><li class="navelem"><a href="directory_8c.html">directory.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
