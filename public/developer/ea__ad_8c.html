<!-- HTML header for doxygen 1.14.0-->
<!-- modified for netatalk -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>netatalk: ea_ad.c File Reference</title>
<link rel="icon" href="favicon.ico" type="image/x-icon" />
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<script
    src="https://cdn.jsdelivr.net/npm/mermaid@11.12.0/dist/mermaid.min.js"
    integrity="o+g/BxPwhi0C3RK7oQBxQuNimeafQ3GE/ST4iT2BxVI4Wzt60SH4pq9iXVYujjaS"
    crossorigin="anonymous"
></script>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
  <div id="projectrow">
    <div id="projectlogo">
      <a href="/"><img alt="Logo" src="logo.png"/></a>
    </div>
    <div id="projectalign">
      <div id="projectname">
        netatalk
        <span id="projectnumber">&#160;4.4.0dev</span>
      </div>
      <div id="projectbrief">Free and Open Source Apple Filing Protocol (AFP) Server</div>
    </div>
  </div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('ea__ad_8c.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">ea_ad.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;arpa/inet.h&gt;</code><br />
<code>#include &lt;dirent.h&gt;</code><br />
<code>#include &lt;errno.h&gt;</code><br />
<code>#include &lt;fcntl.h&gt;</code><br />
<code>#include &lt;stdint.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;sys/stat.h&gt;</code><br />
<code>#include &lt;sys/types.h&gt;</code><br />
<code>#include &lt;unistd.h&gt;</code><br />
<code>#include &lt;<a class="el" href="adouble_8h_source.html">atalk/adouble.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="afp_8h_source.html">atalk/afp.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="compat_8h_source.html">atalk/compat.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="ea_8h_source.html">atalk/ea.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="logger_8h_source.html">atalk/logger.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="include_2atalk_2unix_8h_source.html">atalk/unix.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="include_2atalk_2util_8h_source.html">atalk/util.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="vfs_8h_source.html">atalk/vfs.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="include_2atalk_2volume_8h_source.html">atalk/volume.h</a>&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a191c6a81bc54a6e3f1efb213f0508e68" id="r_a191c6a81bc54a6e3f1efb213f0508e68"><td class="memItemLeft" align="right" valign="top">static mode_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a191c6a81bc54a6e3f1efb213f0508e68">ea_header_mode</a> (mode_t mode)</td></tr>
<tr class="memitem:a50e30012787645b997ae7868f17744d7" id="r_a50e30012787645b997ae7868f17744d7"><td class="memItemLeft" align="right" valign="top">static mode_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a50e30012787645b997ae7868f17744d7">ea_mode</a> (mode_t mode)</td></tr>
<tr class="memitem:a2de89f566c554db0959722299d8f30b1" id="r_a2de89f566c554db0959722299d8f30b1"><td class="memItemLeft" align="right" valign="top">static char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2de89f566c554db0959722299d8f30b1">mtoupath</a> (const struct <a class="el" href="structvol.html">vol</a> *<a class="el" href="structvol.html">vol</a>, const char *mpath)</td></tr>
<tr class="memitem:ae495e97c04d91fb65807fd36c7d5601c" id="r_ae495e97c04d91fb65807fd36c7d5601c"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae495e97c04d91fb65807fd36c7d5601c">unpack_header</a> (struct <a class="el" href="structea.html">ea</a> *<a class="el" href="structea.html">ea</a>)</td></tr>
<tr class="memdesc:ae495e97c04d91fb65807fd36c7d5601c"><td class="mdescLeft">&#160;</td><td class="mdescRight">unpack and verify header file data buffer at ea-&gt;ea_data into struct ea  <br /></td></tr>
<tr class="memitem:a58464e054efd420d4c6c269d0633798a" id="r_a58464e054efd420d4c6c269d0633798a"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a58464e054efd420d4c6c269d0633798a">pack_header</a> (struct <a class="el" href="structea.html">ea</a> *<a class="el" href="structea.html">ea</a>)</td></tr>
<tr class="memdesc:a58464e054efd420d4c6c269d0633798a"><td class="mdescLeft">&#160;</td><td class="mdescRight">pack everything from struct ea into buffer at ea-&gt;ea_data  <br /></td></tr>
<tr class="memitem:acbb662072931d93a7db1f977b53167fa" id="r_acbb662072931d93a7db1f977b53167fa"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acbb662072931d93a7db1f977b53167fa">ea_addentry</a> (struct <a class="el" href="structea.html">ea</a> *<a class="el" href="structea.html">ea</a>, const char *attruname, size_t attrsize, int bitmap)</td></tr>
<tr class="memdesc:acbb662072931d93a7db1f977b53167fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">add one EA into ea-&gt;ea_entries[]  <br /></td></tr>
<tr class="memitem:ae7893a37e7da21e8ca606e56ae9e3b87" id="r_ae7893a37e7da21e8ca606e56ae9e3b87"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae7893a37e7da21e8ca606e56ae9e3b87">create_ea_header</a> (const char *uname, struct <a class="el" href="structea.html">ea</a> *<a class="el" href="structea.html">ea</a>)</td></tr>
<tr class="memdesc:ae7893a37e7da21e8ca606e56ae9e3b87"><td class="mdescLeft">&#160;</td><td class="mdescRight">create EA header file, only called from ea_open  <br /></td></tr>
<tr class="memitem:aa202f54e6c00f216c6a7619eb3de4750" id="r_aa202f54e6c00f216c6a7619eb3de4750"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa202f54e6c00f216c6a7619eb3de4750">write_ea</a> (const struct <a class="el" href="structea.html">ea</a> *<a class="el" href="structea.html">ea</a>, const char *attruname, const char *ibuf, size_t attrsize)</td></tr>
<tr class="memdesc:aa202f54e6c00f216c6a7619eb3de4750"><td class="mdescLeft">&#160;</td><td class="mdescRight">write an EA to disk  <br /></td></tr>
<tr class="memitem:ac9dc1eab5b733ffe34430558b5f6586c" id="r_ac9dc1eab5b733ffe34430558b5f6586c"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac9dc1eab5b733ffe34430558b5f6586c">ea_delentry</a> (struct <a class="el" href="structea.html">ea</a> *<a class="el" href="structea.html">ea</a>, const char *attruname)</td></tr>
<tr class="memdesc:ac9dc1eab5b733ffe34430558b5f6586c"><td class="mdescLeft">&#160;</td><td class="mdescRight">delete one EA from ea-&gt;ea_entries[]  <br /></td></tr>
<tr class="memitem:a4d425ccbf2a5870ec8c0211d5835fc0c" id="r_a4d425ccbf2a5870ec8c0211d5835fc0c"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4d425ccbf2a5870ec8c0211d5835fc0c">delete_ea_file</a> (const struct <a class="el" href="structea.html">ea</a> *<a class="el" href="structea.html">ea</a>, const char *eaname)</td></tr>
<tr class="memdesc:a4d425ccbf2a5870ec8c0211d5835fc0c"><td class="mdescLeft">&#160;</td><td class="mdescRight">delete EA file from disk  <br /></td></tr>
<tr class="memitem:a819b2f2a209dd60880b46b02826f3ab0" id="r_a819b2f2a209dd60880b46b02826f3ab0"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a819b2f2a209dd60880b46b02826f3ab0">ea_path</a> (const struct <a class="el" href="structea.html">ea</a> *<a class="el" href="structea.html">ea</a>, const char *eaname, int macname)</td></tr>
<tr class="memdesc:a819b2f2a209dd60880b46b02826f3ab0"><td class="mdescLeft">&#160;</td><td class="mdescRight">return name of ea header filename  <br /></td></tr>
<tr class="memitem:a46b8ed7a8ebf7e12ee81649945a0bad8" id="r_a46b8ed7a8ebf7e12ee81649945a0bad8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a46b8ed7a8ebf7e12ee81649945a0bad8">ea_open</a> (const struct <a class="el" href="structvol.html">vol</a> *<a class="el" href="structvol.html">vol</a>, const char *uname, <a class="el" href="ea_8h.html#ae4c2c9de19b1667ec3dd044e87fd1f7e">eaflags_t</a> eaflags, struct <a class="el" href="structea.html">ea</a> *<a class="el" href="structea.html">ea</a>)</td></tr>
<tr class="memdesc:a46b8ed7a8ebf7e12ee81649945a0bad8"><td class="mdescLeft">&#160;</td><td class="mdescRight">open EA header file, create if it doesnt exits and called with O_CREATE  <br /></td></tr>
<tr class="memitem:aca8737e07ee8bdd73b2f19359839dbea" id="r_aca8737e07ee8bdd73b2f19359839dbea"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aca8737e07ee8bdd73b2f19359839dbea">ea_openat</a> (const struct <a class="el" href="structvol.html">vol</a> *<a class="el" href="structvol.html">vol</a>, int dirfd, const char *uname, <a class="el" href="ea_8h.html#ae4c2c9de19b1667ec3dd044e87fd1f7e">eaflags_t</a> eaflags, struct <a class="el" href="structea.html">ea</a> *<a class="el" href="structea.html">ea</a>)</td></tr>
<tr class="memdesc:aca8737e07ee8bdd73b2f19359839dbea"><td class="mdescLeft">&#160;</td><td class="mdescRight">openat like wrapper for ea_open, takes a additional file descriptor  <br /></td></tr>
<tr class="memitem:a50f4c63188607f60cc2d4ffd1c5d4978" id="r_a50f4c63188607f60cc2d4ffd1c5d4978"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a50f4c63188607f60cc2d4ffd1c5d4978">ea_close</a> (struct <a class="el" href="structea.html">ea</a> *<a class="el" href="structea.html">ea</a>)</td></tr>
<tr class="memdesc:a50f4c63188607f60cc2d4ffd1c5d4978"><td class="mdescLeft">&#160;</td><td class="mdescRight">flushes and closes an ea handle  <br /></td></tr>
<tr class="memitem:af87f7838de21c822b79656de54f819b0" id="r_af87f7838de21c822b79656de54f819b0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af87f7838de21c822b79656de54f819b0">get_easize</a> (const struct <a class="el" href="structvol.html">vol</a> *<a class="el" href="structvol.html">vol</a>, char *<a class="el" href="afpfunc__helpers_8c.html#ad50ea93b82541b4008d5b84f255a346b">rbuf</a>, size_t *<a class="el" href="afpfunc__helpers_8c.html#a7871fd1d66c15c2c744bd28109af4631">rbuflen</a>, const char *uname, int oflag, const char *attruname, int fd)</td></tr>
<tr class="memdesc:af87f7838de21c822b79656de54f819b0"><td class="mdescLeft">&#160;</td><td class="mdescRight">get size of an EA  <br /></td></tr>
<tr class="memitem:ac56ad99aa4fc19be36ba2585d96bfe00" id="r_ac56ad99aa4fc19be36ba2585d96bfe00"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac56ad99aa4fc19be36ba2585d96bfe00">get_eacontent</a> (const struct <a class="el" href="structvol.html">vol</a> *<a class="el" href="structvol.html">vol</a>, char *<a class="el" href="afpfunc__helpers_8c.html#ad50ea93b82541b4008d5b84f255a346b">rbuf</a>, size_t *<a class="el" href="afpfunc__helpers_8c.html#a7871fd1d66c15c2c744bd28109af4631">rbuflen</a>, const char *uname, int oflag, const char *attruname, int maxreply, int fd)</td></tr>
<tr class="memdesc:ac56ad99aa4fc19be36ba2585d96bfe00"><td class="mdescLeft">&#160;</td><td class="mdescRight">copy EA into rbuf  <br /></td></tr>
<tr class="memitem:a3ebfcbc5e0bc5a5f1f96faed53d6a2d3" id="r_a3ebfcbc5e0bc5a5f1f96faed53d6a2d3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3ebfcbc5e0bc5a5f1f96faed53d6a2d3">list_eas</a> (const struct <a class="el" href="structvol.html">vol</a> *<a class="el" href="structvol.html">vol</a>, char *attrnamebuf, size_t *buflen, const char *uname, int oflag, int fd)</td></tr>
<tr class="memdesc:a3ebfcbc5e0bc5a5f1f96faed53d6a2d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">copy names of EAs into attrnamebuf  <br /></td></tr>
<tr class="memitem:a70b7a176d2104eb20705a300a89e9086" id="r_a70b7a176d2104eb20705a300a89e9086"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a70b7a176d2104eb20705a300a89e9086">set_ea</a> (const struct <a class="el" href="structvol.html">vol</a> *<a class="el" href="structvol.html">vol</a>, const char *uname, const char *attruname, const char *ibuf, size_t attrsize, int oflag, int fd)</td></tr>
<tr class="memdesc:a70b7a176d2104eb20705a300a89e9086"><td class="mdescLeft">&#160;</td><td class="mdescRight">set a Solaris native EA  <br /></td></tr>
<tr class="memitem:a51f64f6fb31e76c7363f1633420ead0b" id="r_a51f64f6fb31e76c7363f1633420ead0b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a51f64f6fb31e76c7363f1633420ead0b">remove_ea</a> (const struct <a class="el" href="structvol.html">vol</a> *<a class="el" href="structvol.html">vol</a>, const char *uname, const char *attruname, int oflag, int fd)</td></tr>
<tr class="memdesc:a51f64f6fb31e76c7363f1633420ead0b"><td class="mdescLeft">&#160;</td><td class="mdescRight">remove a EA from a file  <br /></td></tr>
<tr class="memitem:ab94d9c4146678814e9ced438a17f617a" id="r_ab94d9c4146678814e9ced438a17f617a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab94d9c4146678814e9ced438a17f617a">ea_deletefile</a> (const struct <a class="el" href="structvol.html">vol</a> *<a class="el" href="structvol.html">vol</a>, int dirfd, const char *file)</td></tr>
<tr class="memitem:adef5ee2525953d7aed1b60e7d3d60e82" id="r_adef5ee2525953d7aed1b60e7d3d60e82"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adef5ee2525953d7aed1b60e7d3d60e82">ea_renamefile</a> (const struct <a class="el" href="structvol.html">vol</a> *<a class="el" href="structvol.html">vol</a>, int dirfd, const char *src, const char *dst)</td></tr>
<tr class="memitem:af70f4c191ec7b92beb387b1152bb6779" id="r_af70f4c191ec7b92beb387b1152bb6779"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af70f4c191ec7b92beb387b1152bb6779">ea_copyfile</a> (const struct <a class="el" href="structvol.html">vol</a> *<a class="el" href="structvol.html">vol</a>, int sfd, const char *src, const char *dst)</td></tr>
<tr class="memdesc:af70f4c191ec7b92beb387b1152bb6779"><td class="mdescLeft">&#160;</td><td class="mdescRight">copy EAs  <br /></td></tr>
<tr class="memitem:a32a66bd7a702d0afca2aa5e75624211c" id="r_a32a66bd7a702d0afca2aa5e75624211c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a32a66bd7a702d0afca2aa5e75624211c">ea_chown</a> (const struct <a class="el" href="structvol.html">vol</a> *<a class="el" href="structvol.html">vol</a>, const char *<a class="el" href="structpath.html">path</a>, uid_t uid, gid_t gid)</td></tr>
<tr class="memitem:a7795ad74d00472bfc7319b6758014e70" id="r_a7795ad74d00472bfc7319b6758014e70"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7795ad74d00472bfc7319b6758014e70">ea_chmod_file</a> (const struct <a class="el" href="structvol.html">vol</a> *<a class="el" href="structvol.html">vol</a>, const char *name, mode_t mode, struct stat *st)</td></tr>
<tr class="memitem:af83eb9737ddb83ee095c269a96d1cbec" id="r_af83eb9737ddb83ee095c269a96d1cbec"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af83eb9737ddb83ee095c269a96d1cbec">ea_chmod_dir</a> (const struct <a class="el" href="structvol.html">vol</a> *<a class="el" href="structvol.html">vol</a>, const char *name, mode_t mode, struct stat *st)</td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Store Extended Attributes inside .AppleDouble folders as follows:</p>
<p>filename "fileWithEAs" with EAs "testEA1" and "testEA2"</p>
<ul>
<li>create header with with the format struct adouble_ea_ondisk, the file is written to ".AppleDouble/fileWithEAs::EA"</li>
<li>store EAs in files "fileWithEAs::EA::testEA1" and "fileWithEAs::EA::testEA2" </li>
</ul>
</div><a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function Documentation</h2>
<a id="ae7893a37e7da21e8ca606e56ae9e3b87" name="ae7893a37e7da21e8ca606e56ae9e3b87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7893a37e7da21e8ca606e56ae9e3b87">&#9670;&#160;</a></span>create_ea_header()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int create_ea_header </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>uname</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structea.html">ea</a> *</td>          <td class="paramname"><span class="paramname"><em>ea</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>create EA header file, only called from ea_open </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">uname</td><td>filename for which we have to create a header </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ea</td><td>ea handle with already allocated storage pointed to by ea-&gt;ea_data</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>fd of open header file on success, -1 on error, errno semantics: EEXIST: open with O_CREAT | O_EXCL failed</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Creates EA header file and initialize ea-&gt;ea_data buffer. Possibe race condition with other afpd processes: we were called because header file didn't exist in e.g. ea_open. We then try to create a file with O_CREAT | O_EXCL, but the whole process in not atomic. What do we do then? Someone else is in the process of creating the header too, but it might not have finished it. That means we can't just open, read and use it! We therefor currently just break with an error. On return the header file is still r/w locked. </dd></dl>

</div>
</div>
<a id="a4d425ccbf2a5870ec8c0211d5835fc0c" name="a4d425ccbf2a5870ec8c0211d5835fc0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d425ccbf2a5870ec8c0211d5835fc0c">&#9670;&#160;</a></span>delete_ea_file()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int delete_ea_file </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structea.html">ea</a> *</td>          <td class="paramname"><span class="paramname"><em>ea</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>eaname</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>delete EA file from disk </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ea</td><td>struct ea handle </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eaname</td><td>EA name</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 on error </dd></dl>

</div>
</div>
<a id="acbb662072931d93a7db1f977b53167fa" name="acbb662072931d93a7db1f977b53167fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acbb662072931d93a7db1f977b53167fa">&#9670;&#160;</a></span>ea_addentry()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ea_addentry </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structea.html">ea</a> *</td>          <td class="paramname"><span class="paramname"><em>ea</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>attruname</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>attrsize</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>bitmap</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>add one EA into ea-&gt;ea_entries[] </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ea</td><td>pointer to struct ea </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">attruname</td><td>name of EA </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">attrsize</td><td>size of ea </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bitmap</td><td>bitmap from FP func</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>new number of EA entries, -1 on error</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Grow array ea-&gt;ea_entries[]. If ea-&gt;ea_entries is still NULL, start allocating. Otherwise realloc and put entry at the end. Increments ea-&gt;ea_count. </dd></dl>

</div>
</div>
<a id="af83eb9737ddb83ee095c269a96d1cbec" name="af83eb9737ddb83ee095c269a96d1cbec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af83eb9737ddb83ee095c269a96d1cbec">&#9670;&#160;</a></span>ea_chmod_dir()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ea_chmod_dir </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structvol.html">vol</a> *</td>          <td class="paramname"><span class="paramname"><em>vol</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>name</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">mode_t</td>          <td class="paramname"><span class="paramname"><em>mode</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct stat *</td>          <td class="paramname"><span class="paramname"><em>st</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a7795ad74d00472bfc7319b6758014e70" name="a7795ad74d00472bfc7319b6758014e70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7795ad74d00472bfc7319b6758014e70">&#9670;&#160;</a></span>ea_chmod_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ea_chmod_file </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structvol.html">vol</a> *</td>          <td class="paramname"><span class="paramname"><em>vol</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>name</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">mode_t</td>          <td class="paramname"><span class="paramname"><em>mode</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct stat *</td>          <td class="paramname"><span class="paramname"><em>st</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a32a66bd7a702d0afca2aa5e75624211c" name="a32a66bd7a702d0afca2aa5e75624211c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a32a66bd7a702d0afca2aa5e75624211c">&#9670;&#160;</a></span>ea_chown()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ea_chown </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structvol.html">vol</a> *</td>          <td class="paramname"><span class="paramname"><em>vol</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>path</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uid_t</td>          <td class="paramname"><span class="paramname"><em>uid</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gid_t</td>          <td class="paramname"><span class="paramname"><em>gid</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a50f4c63188607f60cc2d4ffd1c5d4978" name="a50f4c63188607f60cc2d4ffd1c5d4978"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50f4c63188607f60cc2d4ffd1c5d4978">&#9670;&#160;</a></span>ea_close()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ea_close </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structea.html">ea</a> *</td>          <td class="paramname"><span class="paramname"><em>ea</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>flushes and closes an ea handle </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ea</td><td>pointer to ea handle</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 on error</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Flushes and then closes and frees all resouces held by ea handle. Pack data in ea into ea_data, then write ea_data to disk </dd></dl>

</div>
</div>
<a id="af70f4c191ec7b92beb387b1152bb6779" name="af70f4c191ec7b92beb387b1152bb6779"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af70f4c191ec7b92beb387b1152bb6779">&#9670;&#160;</a></span>ea_copyfile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ea_copyfile </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structvol.html">vol</a> *</td>          <td class="paramname"><span class="paramname"><em>vol</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>sfd</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>src</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>dst</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>copy EAs </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">vol</td><td>current volume </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sfd</td><td>source file descriptor </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">src</td><td>source path </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dst</td><td>destination path</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>AFP code AFP_OK on success or appropriate AFP error code</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Copies EAs from source file to dest file. </dd></dl>

</div>
</div>
<a id="ac9dc1eab5b733ffe34430558b5f6586c" name="ac9dc1eab5b733ffe34430558b5f6586c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9dc1eab5b733ffe34430558b5f6586c">&#9670;&#160;</a></span>ea_delentry()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ea_delentry </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structea.html">ea</a> *</td>          <td class="paramname"><span class="paramname"><em>ea</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>attruname</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>delete one EA from ea-&gt;ea_entries[] </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ea</td><td>pointer to struct ea </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">attruname</td><td>EA name</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>new number of EA entries, -1 on error</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Remove entry from ea-&gt;ea_entries[]. Decrement ea-&gt;ea_count. Marks it as unused just by freeing name and setting it to NULL. ea_close and pack_buffer must honor this. </dd></dl>

</div>
</div>
<a id="ab94d9c4146678814e9ced438a17f617a" name="ab94d9c4146678814e9ced438a17f617a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab94d9c4146678814e9ced438a17f617a">&#9670;&#160;</a></span>ea_deletefile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ea_deletefile </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structvol.html">vol</a> *</td>          <td class="paramname"><span class="paramname"><em>vol</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>dirfd</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>file</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a191c6a81bc54a6e3f1efb213f0508e68" name="a191c6a81bc54a6e3f1efb213f0508e68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a191c6a81bc54a6e3f1efb213f0508e68">&#9670;&#160;</a></span>ea_header_mode()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">mode_t ea_header_mode </td>
          <td>(</td>
          <td class="paramtype">mode_t</td>          <td class="paramname"><span class="paramname"><em>mode</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Build mode for EA header from file mode </p>

</div>
</div>
<a id="a50e30012787645b997ae7868f17744d7" name="a50e30012787645b997ae7868f17744d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50e30012787645b997ae7868f17744d7">&#9670;&#160;</a></span>ea_mode()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">mode_t ea_mode </td>
          <td>(</td>
          <td class="paramtype">mode_t</td>          <td class="paramname"><span class="paramname"><em>mode</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Build mode for EA file from file mode </p>

</div>
</div>
<a id="a46b8ed7a8ebf7e12ee81649945a0bad8" name="a46b8ed7a8ebf7e12ee81649945a0bad8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46b8ed7a8ebf7e12ee81649945a0bad8">&#9670;&#160;</a></span>ea_open()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ea_open </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structvol.html">vol</a> *</td>          <td class="paramname"><span class="paramname"><em>vol</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>uname</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ea_8h.html#ae4c2c9de19b1667ec3dd044e87fd1f7e">eaflags_t</a></td>          <td class="paramname"><span class="paramname"><em>eaflags</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structea.html">ea</a> *</td>          <td class="paramname"><span class="paramname"><em>ea</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>open EA header file, create if it doesnt exits and called with O_CREATE </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">vol</td><td>current volume </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">uname</td><td>filename for which we have to open a header </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eaflags</td><td>flag to control open behavior:<ul>
<li>EA_CREATE: create if it doesn't exist (without it won't be created)</li>
<li>EA_RDONLY: open read only</li>
<li>EA_RDWR: open read/write</li>
<li>Either EA_RDONLY or EA_RDWR MUST be requested </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ea</td><td>pointer to a struct ea that we fill</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 on misc error with errno = EFAULT, -2 if no EA header exists with errno = ENOENT</dd></dl>
<dl class="section note"><dt>Note</dt><dd>opens header file and stores fd in ea-&gt;ea_fd. Size of file is put into ea-&gt;ea_size. number of EAs is stored in ea-&gt;ea_count. flags are remembered in ea-&gt;ea_flags. file is either read or write locked depending on the open flags. When you're done with struct ea you must call ea_close on it. </dd></dl>

</div>
</div>
<a id="aca8737e07ee8bdd73b2f19359839dbea" name="aca8737e07ee8bdd73b2f19359839dbea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca8737e07ee8bdd73b2f19359839dbea">&#9670;&#160;</a></span>ea_openat()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ea_openat </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structvol.html">vol</a> *</td>          <td class="paramname"><span class="paramname"><em>vol</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>dirfd</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>uname</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ea_8h.html#ae4c2c9de19b1667ec3dd044e87fd1f7e">eaflags_t</a></td>          <td class="paramname"><span class="paramname"><em>eaflags</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structea.html">ea</a> *</td>          <td class="paramname"><span class="paramname"><em>ea</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>openat like wrapper for ea_open, takes a additional file descriptor </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">vol</td><td>current volume </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dirfd</td><td>openat like file descriptor </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">uname</td><td>filename for which we have to open a header </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eaflags</td><td>flag to control open behavior:<ul>
<li>EA_CREATE: create if it doesn't exist (without it won't be created)</li>
<li>EA_RDONLY: open read only</li>
<li>EA_RDWR: open read/write</li>
<li>Either EA_RDONLY or EA_RDWR MUST be requested </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ea</td><td>pointer to a struct ea that we fill</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 on misc error with errno = EFAULT, -2 if no EA header exists with errno = ENOENT</dd></dl>
<dl class="section note"><dt>Note</dt><dd>opens header file and stores fd in ea-&gt;ea_fd. Size of file is put into ea-&gt;ea_size. number of EAs is stored in ea-&gt;ea_count. flags are remembered in ea-&gt;ea_flags. file is either read or write locked depending on the open flags. When you're done with struct ea you must call ea_close on it. </dd></dl>

</div>
</div>
<a id="a819b2f2a209dd60880b46b02826f3ab0" name="a819b2f2a209dd60880b46b02826f3ab0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a819b2f2a209dd60880b46b02826f3ab0">&#9670;&#160;</a></span>ea_path()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char * ea_path </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structea.html">ea</a> *</td>          <td class="paramname"><span class="paramname"><em>ea</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>eaname</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>macname</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>return name of ea header filename </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ea</td><td>ea handle </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eaname</td><td>name of EA or NULL </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">macname</td><td>if != 0 call mtoupath on eaname</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>pointer to name in static buffer, NULL on error</dd></dl>
<dl class="section note"><dt>Note</dt><dd>- Calls ad_open, copies buffer, appends "::EA" and if supplied append eanme<ul>
<li>Files: "file" -&gt; "file/.AppleDouble/file::EA"</li>
<li>Dirs: "dir" -&gt; "dir/.AppleDouble/.Parent::EA"</li>
<li>"file" with EA "myEA" -&gt; "file/.AppleDouble/file::EA:myEA" </li>
</ul>
</dd></dl>

</div>
</div>
<a id="adef5ee2525953d7aed1b60e7d3d60e82" name="adef5ee2525953d7aed1b60e7d3d60e82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adef5ee2525953d7aed1b60e7d3d60e82">&#9670;&#160;</a></span>ea_renamefile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ea_renamefile </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structvol.html">vol</a> *</td>          <td class="paramname"><span class="paramname"><em>vol</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>dirfd</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>src</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>dst</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac56ad99aa4fc19be36ba2585d96bfe00" name="ac56ad99aa4fc19be36ba2585d96bfe00"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac56ad99aa4fc19be36ba2585d96bfe00">&#9670;&#160;</a></span>get_eacontent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int get_eacontent </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structvol.html">vol</a> *</td>          <td class="paramname"><span class="paramname"><em>vol</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>rbuf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>rbuflen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>uname</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>oflag</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>attruname</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>maxreply</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>fd</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>copy EA into rbuf </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">vol</td><td>current volume </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rbuf</td><td><a class="el" href="struct_d_s_i.html">DSI</a> reply buffer </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rbuflen</td><td>current length of data in reply buffer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">uname</td><td>filename </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">oflag</td><td>link and create flag </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">attruname</td><td>name of attribute </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxreply</td><td>maximum EA size as of current specs/real-life </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fd</td><td>file descriptor</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>AFP code: AFP_OK on success or appropriate AFP error code</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Copies EA into rbuf. Increments *rbuflen accordingly. </dd></dl>

</div>
</div>
<a id="af87f7838de21c822b79656de54f819b0" name="af87f7838de21c822b79656de54f819b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af87f7838de21c822b79656de54f819b0">&#9670;&#160;</a></span>get_easize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int get_easize </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structvol.html">vol</a> *</td>          <td class="paramname"><span class="paramname"><em>vol</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>rbuf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>rbuflen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>uname</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>oflag</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>attruname</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>fd</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>get size of an EA </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">vol</td><td>current volume </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rbuf</td><td><a class="el" href="struct_d_s_i.html">DSI</a> reply buffer </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rbuflen</td><td>current length of data in reply buffer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">uname</td><td>filename </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">oflag</td><td>link and create flag </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">attruname</td><td>name of attribute </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fd</td><td>file descriptor</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>AFP code: AFP_OK on success or appropriate AFP error code</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Copies EA size into rbuf in network order. Increments *rbuflen +4. </dd></dl>

</div>
</div>
<a id="a3ebfcbc5e0bc5a5f1f96faed53d6a2d3" name="a3ebfcbc5e0bc5a5f1f96faed53d6a2d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ebfcbc5e0bc5a5f1f96faed53d6a2d3">&#9670;&#160;</a></span>list_eas()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int list_eas </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structvol.html">vol</a> *</td>          <td class="paramname"><span class="paramname"><em>vol</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>attrnamebuf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>buflen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>uname</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>oflag</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>fd</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>copy names of EAs into attrnamebuf </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">vol</td><td>current volume </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">attrnamebuf</td><td>store names a consecutive C strings here </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">buflen</td><td>length of names in attrnamebuf </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">uname</td><td>filename </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">oflag</td><td>link and create flag </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fd</td><td>file descriptor</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>AFP code: AFP_OK on success or appropriate AFP error code</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Copies names of all EAs of uname as consecutive C strings into rbuf. Increments *buflen accordingly. </dd></dl>

</div>
</div>
<a id="a2de89f566c554db0959722299d8f30b1" name="a2de89f566c554db0959722299d8f30b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2de89f566c554db0959722299d8f30b1">&#9670;&#160;</a></span>mtoupath()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">char * mtoupath </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structvol.html">vol</a> *</td>          <td class="paramname"><span class="paramname"><em>vol</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>mpath</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a58464e054efd420d4c6c269d0633798a" name="a58464e054efd420d4c6c269d0633798a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58464e054efd420d4c6c269d0633798a">&#9670;&#160;</a></span>pack_header()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int pack_header </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structea.html">ea</a> *</td>          <td class="paramname"><span class="paramname"><em>ea</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>pack everything from struct ea into buffer at ea-&gt;ea_data </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ea</td><td>handle to struct ea</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 on error</dd></dl>
<dl class="section note"><dt>Note</dt><dd>adjust ea-&gt;ea_count in case an ea entry deletetion is detected </dd></dl>

</div>
</div>
<a id="a51f64f6fb31e76c7363f1633420ead0b" name="a51f64f6fb31e76c7363f1633420ead0b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51f64f6fb31e76c7363f1633420ead0b">&#9670;&#160;</a></span>remove_ea()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int remove_ea </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structvol.html">vol</a> *</td>          <td class="paramname"><span class="paramname"><em>vol</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>uname</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>attruname</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>oflag</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>fd</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>remove a EA from a file </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">vol</td><td>current volume </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">uname</td><td>filename </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">attruname</td><td>EA name </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">oflag</td><td>link and create flag </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fd</td><td>file descriptor</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>AFP code: AFP_OK on success or appropriate AFP error code</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Removes EA attruname from file uname. </dd></dl>

</div>
</div>
<a id="a70b7a176d2104eb20705a300a89e9086" name="a70b7a176d2104eb20705a300a89e9086"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70b7a176d2104eb20705a300a89e9086">&#9670;&#160;</a></span>set_ea()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int set_ea </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structvol.html">vol</a> *</td>          <td class="paramname"><span class="paramname"><em>vol</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>uname</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>attruname</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>ibuf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>attrsize</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>oflag</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>fd</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>set a Solaris native EA </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">vol</td><td>current volume </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">uname</td><td>filename </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">attruname</td><td>EA name </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ibuf</td><td>buffer with EA content </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">attrsize</td><td>length EA in ibuf </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">oflag</td><td>link and create flag </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fd</td><td>file descriptor</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>AFP code: AFP_OK on success or appropriate AFP error code</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Copies names of all EAs of uname as consecutive C strings into rbuf. Increments *rbuflen accordingly. </dd></dl>

</div>
</div>
<a id="ae495e97c04d91fb65807fd36c7d5601c" name="ae495e97c04d91fb65807fd36c7d5601c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae495e97c04d91fb65807fd36c7d5601c">&#9670;&#160;</a></span>unpack_header()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int unpack_header </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structea.html">ea</a> *</td>          <td class="paramname"><span class="paramname"><em>ea</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>unpack and verify header file data buffer at ea-&gt;ea_data into struct ea </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ea</td><td>handle to struct ea</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 on error</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Verifies magic and version. </dd></dl>

</div>
</div>
<a id="aa202f54e6c00f216c6a7619eb3de4750" name="aa202f54e6c00f216c6a7619eb3de4750"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa202f54e6c00f216c6a7619eb3de4750">&#9670;&#160;</a></span>write_ea()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int write_ea </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structea.html">ea</a> *</td>          <td class="paramname"><span class="paramname"><em>ea</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>attruname</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>ibuf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>attrsize</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>write an EA to disk </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ea</td><td>struct ea handle </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">attruname</td><td>EA name </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ibuf</td><td>buffer with EA content </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">attrsize</td><td>size of EA</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 on error</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Creates/overwrites EA file. </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- HTML footer for doxygen 1.14.0-->
<!-- modified for netatalk -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="dir_f7a34ca911643fbe46878d1e60e6cd22.html">libatalk</a></li><li class="navelem"><a href="dir_53c2c8d41cc27f34344f7f854a3b94ee.html">vfs</a></li><li class="navelem"><a href="ea__ad_8c.html">ea_ad.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
