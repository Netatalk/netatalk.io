# Netatalk Security Advisory

| **Subject**  | Arbitrary code execution in dsi_writeinit |
| ------------ | -------------------------------------- |
| **CVE ID#**  | [CVE-2022-43634](https://www.cve.org/CVERecord?id=CVE-2022-43634) |
| **Date**     | 2023/02/20 |
| **Versions** | 3.0.0 - 3.1.14 |
| **Summary**  | Lack of validation of user-input data leads to remote code execution in the dsi_writeinit function |

## Description

This vulnerability allows remote attackers to execute arbitrary code
on Netatalk without requiring authentication.

The flaw resides in the *dsi_writeinit* function,
where the length of user-supplied data is not properly validated
before being copied into a fixed-length heap-based buffer.

An attacker can exploit this vulnerability
to execute code with root-level privileges.

## Patch Availability

Apply the patch with git hash
[5fcb4ab](https://github.com/Netatalk/netatalk/commit/5fcb4ab02aced14484310165b3d754bb2f0820ca.diff)
to hotfix your local Netatalk deployment.

Additionally, Netatalk 3.1.15 has been released which contains the
security patch. Netatalk administrators are advised to upgrade to this
version or apply the patch as soon as possible.

## CVSS Calculation

CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (9.8)

## Workaround

None.

## Credits

Vulnerability found and reported by:

> Corentin BAYET (@OnlyTheDuck), Etienne HELLUY-LAFONT and Luca MORO
(@johncool\_\_) from Synacktiv

Patch developed by:

> Etienne HELLUY-LAFONT from Synacktiv

## References

- [Zero Day Initiative advisory](https://www.zerodayinitiative.com/advisories/ZDI-23-094/)
- [GitHub pull request](https://github.com/Netatalk/netatalk/pull/186)

---

Go back to the [Security Policy](/security.html).
