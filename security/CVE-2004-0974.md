# Netatalk Security Advisory

| **Subject**  | etc2ps.sh vulnerable to symlink attack |
| ------------ | -------------------------------------- |
| **CVE ID#**  | [CAN-2004-0974](https://www.cve.org/CVERecord?id=CVE-2004-0974) |
| **Date**     | 2004/09/30 |
| **Versions** | 2.0.0, 1.3 - 1.6.4 |
| **Summary**  | The etc2ps.sh script allows local users to overwrite files |

## Description

The etc2ps.sh script delivered with all Netatalk versions prior to 2.0.1
allows local users to overwrite files via a symlink attack on temporary
files.

## Patch Availability

Apply [this patch](CVE-2004-0974.diff) to hotfix your local Netatalk
deployment.

Additionally, Netatalk 2.0.1 and 1.6.4a have been released which contain
the updated script. Netatalk administrators are advised to upgrade to
this version as soon as possible.

## CVSS Calculation

CVSS:1.0/AV:L/AC:L/Au:N/C:N/I:P/A:N (2.5)

## Workaround

None.

## Credits

Vulnerability found and reported by:

> Trustix

Patch developed by:

> Bjoern Fernhomberg of the Netatalk team

## References

- [Trustix Secure Linux Bugfix Advisory](https://web.archive.org/web/20050207103853/http://www.trustix.org/errata/2004/0050/)
- [IBM X-Force Vulnerability Report](https://exchange.xforce.ibmcloud.com/vulnerabilities/17583)

---

Go back to the [Security Policy](/security.html).
